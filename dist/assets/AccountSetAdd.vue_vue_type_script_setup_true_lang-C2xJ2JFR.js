import{d as b,i as v,r as x,k as p,b as s,n as E,a as k,w as a,e as l,f as C,g as w,q as N,s as f,ag as q,E as c}from"./index-DSXWNbz6.js";const F={class:"dialog-footer"},B=b({__name:"AccountSetAdd",props:{modelValue:{},modelModifiers:{}},emits:["update:modelValue"],setup(g){const n=v(g,"modelValue"),u=x(),o=p({pwd:"",newPwd:"",confirmPwd:""}),_=p({pwd:[{required:!0,message:"请输入旧密码",trigger:"blur"}],newPwd:[{required:!0,message:"请输入新密码",trigger:"blur"}],confirmPwd:[{required:!0,message:"请再次输入新密码",trigger:"blur"},{validator:(d,e,t)=>{e===o.newPwd?t():t(new Error("两次输入的密码不一致"))},trigger:"blur"}]}),V=async()=>{if(u.value)try{await u.value.validate(async d=>{if(d){let e=await N();o.pwd=f.sm2.doEncrypt(o.pwd,e.data),o.newPwd=f.sm2.doEncrypt(o.newPwd,e.data);let t=await q(JSON.parse(JSON.stringify(o)));console.log("修改密码",t),c.success("密码修改成功"),n.value=!1}})}catch(d){console.error("密码修改失败:",d),c.error("密码修改失败，请重试")}};return(d,e)=>{const t=s("el-input"),i=s("el-form-item"),y=s("el-form"),m=s("el-button"),P=s("el-dialog");return k(),E(P,{modelValue:n.value,"onUpdate:modelValue":e[4]||(e[4]=r=>n.value=r),title:"",width:"500"},{footer:a(()=>[C("div",F,[l(m,{onClick:e[3]||(e[3]=r=>n.value=!1)},{default:a(()=>[...e[5]||(e[5]=[w("关闭",-1)])]),_:1}),l(m,{type:"primary",onClick:V},{default:a(()=>[...e[6]||(e[6]=[w(" 提交 ",-1)])]),_:1})])]),default:a(()=>[l(y,{ref_key:"ruleFormRef",ref:u,style:{"max-width":"600px"},model:o,rules:_,"label-width":"auto"},{default:a(()=>[l(i,{label:"输入旧密码",prop:"pwd"},{default:a(()=>[l(t,{type:"password",modelValue:o.pwd,"onUpdate:modelValue":e[0]||(e[0]=r=>o.pwd=r)},null,8,["modelValue"])]),_:1}),l(i,{label:"输入新密码",prop:"newPwd"},{default:a(()=>[l(t,{type:"password",modelValue:o.newPwd,"onUpdate:modelValue":e[1]||(e[1]=r=>o.newPwd=r)},null,8,["modelValue"])]),_:1}),l(i,{label:"再次输入新密码",prop:"confirmPwd"},{default:a(()=>[l(t,{type:"password",modelValue:o.confirmPwd,"onUpdate:modelValue":e[2]||(e[2]=r=>o.confirmPwd=r)},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue"])}}});export{B as _};
