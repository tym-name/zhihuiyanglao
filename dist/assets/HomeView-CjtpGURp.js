import{D as C,d as g,r as _,a0 as $,o as x,c as v,f as t,u as f,t as h,a as m,_ as b,k as E,W as z,x as I,E as O,e as S,w as L,b as W,n as p,p as y}from"./index-DSXWNbz6.js";import{A as G}from"./index-Cfhc2B4z.js";import{i as A,L as k}from"./index-BKAZWf-8.js";const P=()=>C.get("/count/list"),V=()=>C.get("/count/getOrderCount"),T=()=>C.get("/count/getAgeGroup"),B=()=>C.get("/count/getElderlyCount"),H={class:"summary_box"},N={class:"left"},j=["src"],F={class:"tips_box"},U={class:"username"},q={class:"tips"},J={class:"weather"},K={class:"quotation"},Q={class:"right"},X={class:"item"},Y={class:"number"},Z={class:"item"},ee={class:"number"},te={class:"item"},ae={class:"number"},oe=g({__name:"summary",setup(w){const i=_({bedCounts:0,companyCounts:0,elderlyCounts:0}),o=async()=>{const r=await P();i.value=r.data};window._AMapSecurityConfig={securityJsCode:"42d0b385a5c790c3b3588f143717229a"};const s=$(),l=s.model,d="http://123.57.237.81:8080/caresystem/",n=_({}),a=r=>{if(!r)return"";try{const u=new Date(r).getHours();return u>=6&&u<9?"早上好":u>=9&&u<12?"上午好":u>=12&&u<14?"中午好":u>=14&&u<18?"下午好":u>=18&&u<22?"晚上好":"夜深了"}catch(c){return console.error("时间解析错误:",c),""}},e=r=>{if(!r)return"今天也是充满希望的一天!";try{switch(new Date(r).getDay()){case 0:return"周日是新的开始，放松自己，准备迎接新的一周吧!";case 1:return"周一早上好!新的一周，新的挑战，加油!";case 2:return"周二了，工作状态渐入佳境，继续努力!";case 3:return"周三是一周的中点，坚持就是胜利!";case 4:return"周四了，周末就在眼前，再坚持一下!";case 5:return"周五啦!工作收尾，准备享受周末时光!";case 6:return"周六愉快!好好休息，充充电吧!";default:return"今天也是充满希望的一天!"}}catch(c){return console.error("星期解析错误:",c),"今天也是充满希望的一天!"}};return x(async()=>{o();const r=await G.load({key:"acfafaaa6141cac32e8af91958cb7580",version:"2.0",plugins:["AMap.Weather"]});r.plugin("AMap.Weather",function(){var c=new r.Weather;c.getLive(s.ipAddress,function(u,D){console.log("实时天气数据",D),n.value=D})})}),(r,c)=>(m(),v("div",H,[t("div",N,[t("img",{src:f(d)+f(l).photo,alt:"",class:"header"},null,8,j),t("div",F,[t("p",U,h(a(n.value.reportTime))+"，"+h(f(l).username),1),t("div",q,[t("p",J,h(n.value.city)+" "+h(n.value.weather)+" 当前温度:"+h(n.value.temperature)+"℃",1),t("p",K,h(e(n.value.reportTime)),1)])])]),t("div",Q,[t("div",X,[c[0]||(c[0]=t("div",{class:"item_name"},[t("i",{class:"iconfont icon-bangong-jigou"}),t("span",null,"机构数")],-1)),t("p",Y,h(i.value.companyCounts),1)]),t("div",Z,[c[1]||(c[1]=t("div",{class:"item_name"},[t("i",{style:{color:"#d81e06"},class:"iconfont icon-bed"}),t("span",null,"床位数")],-1)),t("p",ee,h(i.value.bedCounts),1)]),t("div",te,[c[2]||(c[2]=t("div",{class:"item_name"},[t("i",{style:{color:"#47d99b"},class:"iconfont icon-oldy"}),t("span",null,"老人数")],-1)),t("p",ae,h(i.value.elderlyCounts),1)])])]))}}),se=b(oe,[["__scopeId","data-v-a9971530"]]),ne={class:"chart-container"},re=g({__name:"institution",setup(w){const i=_(null);let o=null;const s=E({months:[],admission:[],discharge:[],booking:[]}),l=async()=>{try{const a=await V();console.log("订单统计数据:",a),a.data&&a.data.length>0&&(s.months=a.data.map(e=>e.name),s.admission=a.data.map(e=>e.count||Math.floor(Math.random()*20)),s.discharge=a.data.map(()=>Math.floor(Math.random()*15)),s.booking=a.data.map(()=>Math.floor(Math.random()*10)),d())}catch(a){console.error("获取订单统计数据失败:",a)}};x(async()=>{if(!i.value)return;o=A(i.value);const a={tooltip:{trigger:"axis",formatter:function(e){let r=e[0].axisValue+"<br/>";return e.forEach(c=>{r+=`${c.marker}${c.seriesName} ${c.value}<br/>`}),r}},grid:{left:"3%",right:"4%",bottom:"15%",containLabel:!0},xAxis:{type:"category",data:s.months.length>0?s.months:["2025年03月","2025年04月","2025年07月"],axisLine:{lineStyle:{color:"#ccc"}},axisTick:{show:!1}},yAxis:{type:"value",min:0,max:100,interval:20,axisLine:{show:!1},axisTick:{show:!1},splitLine:{lineStyle:{color:"#f0f0f0"}}},legend:{data:["入院","出院","预定"],bottom:"0%",itemWidth:10,itemHeight:10,textStyle:{fontSize:12},icon:"circle"},series:[{name:"入院",type:"line",data:s.admission.length>0?s.admission:[10,0,6],smooth:!0,symbol:"circle",symbolSize:8,lineStyle:{color:"#91cc75",width:2},itemStyle:{color:"#91cc75"},areaStyle:{color:new k(0,0,0,1,[{offset:0,color:"rgba(145, 204, 117, 0.3)"},{offset:1,color:"rgba(145, 204, 117, 0.05)"}])}},{name:"出院",type:"line",data:s.discharge.length>0?s.discharge:[2,10,3],smooth:!0,symbol:"circle",symbolSize:8,lineStyle:{color:"#fac858",width:2},itemStyle:{color:"#fac858"},areaStyle:{color:new k(0,0,0,1,[{offset:0,color:"rgba(250, 200, 88, 0.3)"},{offset:1,color:"rgba(250, 200, 88, 0.05)"}])}},{name:"预定",type:"line",data:s.booking.length>0?s.booking:[4,1,14],smooth:!0,symbol:"circle",symbolSize:8,lineStyle:{color:"#ee6666",width:2},itemStyle:{color:"#ee6666"},areaStyle:{color:new k(0,0,0,1,[{offset:0,color:"rgba(238, 102, 102, 0.3)"},{offset:1,color:"rgba(238, 102, 102, 0.05)"}])}}]};o.setOption(a),window.addEventListener("resize",n),await l()});const d=()=>{o&&o.setOption({xAxis:{data:s.months},series:[{name:"入院",data:s.admission},{name:"出院",data:s.discharge},{name:"预定",data:s.booking}]})},n=()=>{o?.resize()};return z(()=>{o?.dispose(),window.removeEventListener("resize",n)}),(a,e)=>(m(),v("div",ne,[e[0]||(e[0]=t("div",{class:"chart-header"},[t("h3",null,"出院、入院、预定统计"),t("span",{class:"download-icon"},"↓")],-1)),t("div",{ref_key:"chartRef",ref:i,class:"chart"},null,512)]))}}),M=b(re,[["__scopeId","data-v-afcaeb75"]]),ie={class:"chart-container"},ce=g({__name:"initPieChart",setup(w){const i=_(null);let o=null;const s={"60以下":"#316bf3","60-70":"#47d99b","70-80":"#f0c343","90以上":"#ef6366"},l=E({ageData:[{name:"60以下",value:45,color:"#316bf3"},{name:"60-70",value:25,color:"#47d99b"},{name:"70-80",value:15,color:"#f0c343"},{name:"90以上",value:15,color:"#ef6366"}]}),d=async()=>{try{const e=await T();console.log("接口返回数据：",e),Array.isArray(e)?l.ageData=e.map(r=>({...r,color:s[r.name]||"#999"})):e?.data&&Array.isArray(e.data)&&(l.ageData=e.data.map(r=>({...r,color:s[r.name]||"#999"}))),o&&o.setOption(n(),!0)}catch(e){console.log("获取年龄段数据失败：",e)}},n=()=>({padding:[20,20,40,20],tooltip:{trigger:"item",formatter:"{b}: {c} ({d}%)",textStyle:{fontSize:14}},legend:{orient:"horizontal",bottom:-5,left:"center",type:"plain",itemGap:25,itemWidth:14,itemHeight:14,textStyle:{fontSize:14,color:"#333",padding:[0,0,0,5]},data:l.ageData.map(e=>e.name)},series:[{name:"年龄分布",type:"pie",radius:["40%","60%"],center:["50%","45%"],startAngle:90,label:{show:!0,position:"outside",formatter:"{b}",fontSize:14,color:"#333"},labelLine:{show:!0,length:50,length2:60,lineStyle:{width:1}},itemStyle:{borderRadius:0,borderColor:"#fff",borderWidth:3,color:e=>e.data.color||"#999"},data:l.ageData}]}),a=()=>{o?.resize()};return x(async()=>{i.value&&(o=A(i.value),o.setOption(n()),await d(),window.addEventListener("resize",a))}),z(()=>{o?.dispose(),window.removeEventListener("resize",a)}),(e,r)=>(m(),v("div",ie,[r[0]||(r[0]=t("div",{class:"chart-header"},[t("h3",null,"各年龄段数量统计")],-1)),t("div",{ref_key:"chartRef",ref:i,class:"chart"},null,512)]))}}),R=b(ce,[["__scopeId","data-v-2aba4f4c"]]),le={class:"chart-container"},de={class:"chart-section"},ue=g({__name:"getCompanyCount",setup(w){const i=_(null),o=I(null),s=async()=>{try{const n=await fetch("http://123.57.237.81:8080/caresystem-server/api/count/getCompanyCount");if(!n.ok)throw new Error("API请求失败");const a=await n.json();a.code===1e4&&l(a.data||[])}catch{O.error("数据加载失败")}},l=n=>{o.value?.setOption({tooltip:{trigger:"axis",axisPointer:{type:"shadow"}},grid:{left:"3%",right:"4%",bottom:"3%",containLabel:!0},xAxis:{type:"category",data:n.slice(0,15).map(a=>a.name),axisLabel:{rotate:45,fontSize:10}},yAxis:{type:"value"},series:[{name:"机构数量",type:"bar",data:n.slice(0,15).map(a=>a.count),itemStyle:{color:"#4A9EFF"}}]})},d=()=>{o.value?.resize()};return x(async()=>{i.value&&(o.value=A(i.value),await s()),window.addEventListener("resize",d)}),z(()=>{window.removeEventListener("resize",d),o.value?.dispose()}),(n,a)=>(m(),v("div",le,[t("div",de,[a[0]||(a[0]=t("h3",{class:"section-title"},"机构分布统计",-1)),t("div",{ref_key:"chartRef",ref:i,class:"chart-canvas"},null,512)])]))}}),me=b(ue,[["__scopeId","data-v-a34efa65"]]),he={class:"chart-container"},fe=g({__name:"getElderlyCount",setup(w){const i=_(null);let o=null;const s=E({regions:["北京","河北","山东","浙江","黑龙江","贵州","湖北","天津","上海"],counts:[80,38,29,28,12,11,9,4,2]}),l=()=>({tooltip:{trigger:"axis",axisPointer:{type:"shadow"},formatter:"{b}: {c} 人",textStyle:{fontSize:14}},grid:{left:"3%",right:"4%",bottom:"3%",containLabel:!0},xAxis:{type:"category",data:s.regions,axisLabel:{fontSize:12,color:"#333"},axisLine:{lineStyle:{color:"#ccc"}}},yAxis:{type:"value",min:0,axisLabel:{fontSize:12,color:"#333"},axisLine:{show:!1},splitLine:{lineStyle:{color:"#f0f0f0"}}},series:[{name:"老人数量",type:"bar",data:s.counts,itemStyle:{color:"#2196f3"},barWidth:"60%"}]}),d=()=>{o?.resize()};return x(async()=>{if(i.value){o=A(i.value),o.setOption(l());try{const n=await B();if(console.log("接口返回数据：",n),n?.data&&Array.isArray(n.data)){const a=[...n.data].sort((e,r)=>(r.value||r.count)-(e.value||e.count));s.regions=a.map(e=>e.name),s.counts=a.map(e=>e.value||e.count)}else if(Array.isArray(n)){const a=[...n].sort((e,r)=>(r.value||r.count)-(e.value||e.count));s.regions=a.map(e=>e.name),s.counts=a.map(e=>e.value||e.count)}o&&o.setOption(l())}catch(n){console.error("获取老人数量数据失败：",n)}window.addEventListener("resize",d)}}),z(()=>{o?.dispose(),window.removeEventListener("resize",d)}),(n,a)=>(m(),v("div",he,[a[0]||(a[0]=t("div",{class:"chart-header"},[t("h3",null,"各地区老人柱状图")],-1)),t("div",{ref_key:"chartRef",ref:i,class:"chart"},null,512)]))}}),pe=b(fe,[["__scopeId","data-v-d707190e"]]),ye={class:"echarts"},_e=g({__name:"HomeView",setup(w){const o=$().model;return(s,l)=>{const d=W("el-card");return m(),v("div",null,[S(d,null,{default:L(()=>[S(se)]),_:1}),t("div",ye,[S(d,{class:"left"},{default:L(()=>[f(o).username==="cpglyzh"?(m(),p(M,{key:0})):y("",!0),f(o).username==="cstext"?(m(),p(M,{key:1})):y("",!0),f(o).username==="admin"?(m(),p(me,{key:2})):y("",!0)]),_:1}),S(d,{class:"right"},{default:L(()=>[f(o).username==="cpglyzh"?(m(),p(R,{key:0})):y("",!0),f(o).username==="cstext"?(m(),p(R,{key:1})):y("",!0),f(o).username==="admin"?(m(),p(pe,{key:2})):y("",!0)]),_:1})])])}}}),we=b(_e,[["__scopeId","data-v-dbe10981"]]);export{we as default};
