import{T as Z}from"./table-B1my3jl3.js";import{t as N,d as M,r as i,l as Y,a as u,n as P,b as v,w as l,e,c as V,f as r,v as w,F as E,x as F,g as C,u as H,_ as O,p as ee,E as j,h as A}from"./index-D6YPj1KB.js";const le=p=>N.get("/play/list",p),te=()=>N.get("/playType/list"),ae=p=>N.get(`/play/get/${p}`),oe=p=>N.delete(`/play/delete/${p}`),ne=p=>N.post("/api/play/deleteAll",p),se=["src"],ie=M({__name:"ViewDetails",props:{drawer:{type:Boolean},id:{},typeList:{},close:{type:Function}},setup(p){const m="http://123.57.237.81:8080/caresystem/",g=p,b=i(null);Y(()=>g.id,o=>{b.value=o,D()});const n=i([]);Y(()=>g.typeList,o=>{n.value=o});const y=i(null),D=async()=>{if(b.value)try{let o=await ae(b.value);console.log("单条院内活动信息",o),y.value=o.data,o.data&&x(o.data),I(o.data.content)}catch(o){console.error("获取活动详情失败:",o)}},s=i(""),x=o=>{n.value.forEach(c=>{o.type===c.id&&(s.value=c.name)})},B=i(""),I=o=>B.value=o.replace(/<[^>]*>/g,"");return(o,c)=>{const f=u("el-form-item"),L=u("el-button"),U=u("el-form"),$=u("el-drawer");return v(),P($,{modelValue:g.drawer,"onUpdate:modelValue":c[0]||(c[0]=_=>g.drawer=_),title:"查看详情"},{default:l(()=>[e(U,{"label-width":"auto"},{default:l(()=>[e(f,{label:"活动名称:"},{default:l(()=>[r(w(y.value?.title),1)]),_:1}),e(f,{label:"分类:"},{default:l(()=>[r(w(s.value),1)]),_:1}),e(f,{label:"参与老人:"},{default:l(()=>[(v(!0),V(E,null,F(y.value?.elderly,_=>(v(),V("div",{class:"content title_content",key:_.id},w(_.elderlyName),1))),128))]),_:1}),e(f,{label:"活动内容:"},{default:l(()=>[r(w(B.value),1)]),_:1}),(v(!0),V(E,null,F(y.value?.pictures,_=>(v(),P(f,{label:"图片:",key:_},{default:l(()=>[C("img",{src:H(m)+_.picture,alt:"",class:"image"},null,8,se)]),_:2},1024))),128)),e(f,{label:"上报时间:"},{default:l(()=>[r(w(y.value?.addTime),1)]),_:1}),e(f,null,{default:l(()=>[e(L,{onClick:g.close},{default:l(()=>[...c[1]||(c[1]=[r("关闭",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1},8,["modelValue"])}}}),de=O(ie,[["__scopeId","data-v-b67c2f11"]]),ue={class:"dialog-footer"},re=M({__name:"PlayAddOrUpdate",props:{open:{type:Boolean},close:{type:Function}},setup(p){const m=p,g=i(!1);return(b,n)=>{const y=u("el-button"),D=u("el-dialog");return v(),V("div",null,[e(D,{modelValue:m.open,"onUpdate:modelValue":n[1]||(n[1]=s=>m.open=s),title:"增加院内活动","before-close":m.close,width:"900px"},{footer:l(()=>[C("div",ue,[e(y,{onClick:m.close},{default:l(()=>[...n[2]||(n[2]=[r("取消",-1)])]),_:1},8,["onClick"]),e(y,{type:"primary",onClick:n[0]||(n[0]=s=>g.value=!1)},{default:l(()=>[...n[3]||(n[3]=[r(" 提交 ",-1)])]),_:1})])]),_:1},8,["modelValue","before-close"])])}}}),pe={key:0},ce=M({__name:"Activity",setup(p){const m=i(null),g=[{type:"selection",width:"50"},{label:"序号",prop:"id"},{label:"标题",prop:"title"},{label:"老人姓名",slot:"elderlyNames"},{label:"分类",prop:"typeName"},{label:"上报人",prop:"addAccountName"},{label:"上报时间",prop:"addTime",formatTime:"YYYY-MM-DD HH:mm"},{label:"操作",width:240,slot:"operate",fixed:"right"}],b=()=>{m.value?.refresh()},n=i(!1),y=()=>{n.value=!n.value},D=()=>{n.value=!1},s=i({name:"",beginDate:"",endDate:"",type:null,key:""}),x=i([]);(async()=>{let d=await te();console.log(d),x.value=d.data.list})();const I=()=>{m.value.refresh()},o=()=>{s.value={name:"",beginDate:"",endDate:"",type:null,key:""},m.value.refresh()},c=i(!1),f=i(0),L=d=>{c.value=!c.value,f.value=d},U=()=>{c.value=!1},$=d=>{j.confirm("是否删除该条记录？",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(async()=>{await oe(d),A({type:"success",message:"删除成功"}),b()})},_=i(!0),q=i([]),R=i([]),G=d=>{q.value=d,R.value=d.map(t=>t.id),_.value=d.length===0},z=async()=>{j.confirm("是否删除多条记录？",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(async()=>{let d=await ne(R.value);console.log(d),d.code===1e4&&(A({type:"success",message:"删除成功"}),b())}).catch(()=>{A({type:"info",message:"取消删除"})})};return(d,t)=>{const J=u("el-option"),K=u("el-select"),h=u("el-form-item"),S=u("el-input"),Q=u("el-date-picker"),k=u("el-button"),W=u("el-form"),X=u("el-tooltip");return v(),V("div",null,[e(Z,{ref_key:"tableRef",ref:m,columns:g,"fetch-data":H(le),"init-params":s.value,onSelectionChange:G},{search:l(()=>[e(W,{inline:!0,class:"demo-form-inline"},{default:l(()=>[e(h,{label:"分类"},{default:l(()=>[e(K,{modelValue:s.value.type,"onUpdate:modelValue":t[0]||(t[0]=a=>s.value.type=a),placeholder:"请选择类型",style:{width:"240px"}},{default:l(()=>[(v(!0),V(E,null,F(x.value,a=>(v(),P(J,{key:a.id,label:a.name,value:a.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(h,{label:"老人姓名"},{default:l(()=>[e(S,{modelValue:s.value.name,"onUpdate:modelValue":t[1]||(t[1]=a=>s.value.name=a),placeholder:"请输入老人姓名",clearable:""},null,8,["modelValue"])]),_:1}),e(h,{label:"活动标题"},{default:l(()=>[e(S,{modelValue:s.value.key,"onUpdate:modelValue":t[2]||(t[2]=a=>s.value.key=a),placeholder:"请输入活动标题",clearable:""},null,8,["modelValue"])]),_:1}),e(h,{label:"上报时间"},{default:l(()=>[e(Q,{modelValue:s.value.beginDate,"onUpdate:modelValue":t[3]||(t[3]=a=>s.value.beginDate=a),type:"daterange","range-separator":"-","start-placeholder":"开始日期","end-placeholder":"结束日期",style:{width:"240px"}},null,8,["modelValue"])]),_:1}),e(h,null,{default:l(()=>[e(k,{type:"primary",onClick:I},{default:l(()=>[...t[4]||(t[4]=[r("查询",-1)])]),_:1}),e(k,{onClick:o},{default:l(()=>[...t[5]||(t[5]=[r("重置",-1)])]),_:1})]),_:1})]),_:1})]),buttons:l(()=>[e(k,{type:"success",onClick:y},{default:l(()=>[...t[6]||(t[6]=[r("添加",-1)])]),_:1}),e(k,{type:"danger",onClick:z,disabled:_.value},{default:l(()=>[...t[7]||(t[7]=[r("批量删除",-1)])]),_:1},8,["disabled"])]),operate:l(({row:a})=>[e(k,{link:"",type:"primary",onClick:T=>L(a.id)},{default:l(()=>[...t[8]||(t[8]=[C("i",{class:"iconfont icon-xiangqing"},null,-1),r(" 详情 ",-1)])]),_:1},8,["onClick"]),e(k,{link:"",type:"primary"},{default:l(()=>[...t[9]||(t[9]=[C("i",{class:"iconfont icon-bianji"},null,-1),r(" 编辑 ",-1)])]),_:1}),e(k,{link:"",type:"danger",onClick:T=>$(a.id)},{default:l(()=>[...t[10]||(t[10]=[C("i",{class:"iconfont icon-shanchu"},null,-1),r(" 删除 ",-1)])]),_:1},8,["onClick"])]),elderlyNames:l(({row:a})=>[a.elderly&&a.elderly.length>0?(v(),V("div",pe,[e(X,{content:a.elderly.map(T=>T.elderlyName).join("、"),placement:"top"},{default:l(()=>[C("span",null,w(a.elderly.map(T=>T.elderlyName).join("、")),1)]),_:2},1032,["content"])])):ee("",!0)]),_:1},8,["fetch-data","init-params"]),e(de,{drawer:c.value,id:f.value,typeList:x.value,close:U},null,8,["drawer","id","typeList"]),e(re,{open:n.value,close:D},null,8,["open"])])}}}),fe=O(ce,[["__scopeId","data-v-259f7b97"]]);export{fe as default};
