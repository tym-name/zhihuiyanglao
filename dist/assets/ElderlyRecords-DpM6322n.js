import{d as E,r as c,o as k,z as C,c as g,e as l,f as t,w as s,b as m,u as w,t as f,g as I,a as x,_ as S}from"./index-DSXWNbz6.js";import{c as B,f as L,h as R}from"./elderly-p1gfo6w8.js";import{u as T}from"./Uploads-hqb4toZy.js";const F=["src"],$={style:{flex:"1",display:"flex","flex-direction":"column",gap:"8px"}},z={style:{display:"flex","align-items":"center","margin-bottom":"10px"}},A={style:{display:"flex","align-items":"center","margin-bottom":"10px"}},G={style:{display:"flex","align-items":"center"}},M={style:{"background-color":"#fff"}},j={key:0,style:{color:"#409EFF",cursor:"pointer"}},q={key:1},D={style:{"text-align":"center",padding:"20px"}},O=E({__name:"ElderlyRecords",setup(P){const r=c({}),N="http://123.57.237.81:8080/caresystem-server/api",v="http://123.57.237.81:8080/caresystem/",U=N+"/upload/add",b=C(),_=c(0),u=c([]),i=c("");k(async()=>{const o=b.query.id||b.params.id;_.value=Number(o);const e=await B(_.value);console.log("老人详情",e),r.value=e.data;const n=await L();console.log("申请表",n),u.value=n.data.list});const V=async o=>{const e=i.value.substring(i.value.lastIndexOf("/")+1),n={elderlyId:_.value,name:o.name,fileName:e,id:0};try{const a=await R(n);console.log("文件上传关联成功",a);const d=u.value.findIndex(y=>y.id===o.id);d!==-1&&(u.value[d].fileName=e),i.value=""}catch(a){console.error("文件上传关联失败",a)}};return(o,e)=>{const n=m("el-card"),a=m("el-table-column"),d=m("el-button"),y=m("el-table");return x(),g("div",null,[l(n,{style:{"margin-bottom":"10px"}},{default:s(()=>[t("img",{src:w(v)+r.value.photo,style:{width:"60px",height:"60px","border-radius":"4px","object-fit":"cover","margin-right":"30px"}},null,8,F),t("div",$,[t("div",z,[e[2]||(e[2]=t("span",{style:{width:"120px","text-align":"left","margin-right":"80px"}},"老人姓名:",-1)),t("span",null,f(r.value.name),1)]),t("div",A,[e[3]||(e[3]=t("span",{style:{width:"120px","text-align":"left","margin-right":"80px"}},"身份证/护照号:",-1)),t("span",null,f(r.value.idCard),1)]),t("div",G,[e[4]||(e[4]=t("span",{style:{width:"120px","text-align":"left","margin-right":"80px"}},"床位号:",-1)),t("span",null,f(r.value.bedNo||"无"),1)])])]),_:1}),t("div",M,[l(y,{data:u.value,border:"",style:{width:"100%"}},{default:s(()=>[l(a,{label:"序号",type:"index",width:"80",align:"center"}),l(a,{label:"项目",prop:"name",align:"center"}),l(a,{label:"文件",prop:"fileName",align:"center"},{default:s(p=>[p.row.fileName?(x(),g("span",j,f(p.row.fileName),1)):(x(),g("span",q,"暂无文件"))]),_:1}),l(a,{label:"操作",align:"center",width:"120"},{default:s(p=>[l(T,{modelValue:i.value,"onUpdate:modelValue":e[0]||(e[0]=h=>i.value=h),baseUrl:w(v),uploadUrl:U,isText:!0,onSuccess:h=>V(p.row)},{"upload-text":s(()=>[l(d,{type:"primary",size:"small"},{default:s(()=>[...e[5]||(e[5]=[I("上传图片",-1)])]),_:1})]),_:1},8,["modelValue","baseUrl","onSuccess"])]),_:1})]),_:1},8,["data"]),t("div",D,[l(d,{type:"primary",onClick:e[1]||(e[1]=p=>o.$router.push("/elderly"))},{default:s(()=>[...e[6]||(e[6]=[I("返回",-1)])]),_:1})])])])}}}),Q=S(O,[["__scopeId","data-v-69dc728c"]]);export{Q as default};
