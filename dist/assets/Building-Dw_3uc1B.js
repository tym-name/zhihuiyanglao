import{b as U,a as D,c as L,d as M}from"./building-CNUBr-fR.js";import{d as R,r as p,k as b,b as u,n as S,a as q,w as l,f as o,e as s,g as _,t as A,V as I,h as z,E as m,_ as G}from"./index-DSXWNbz6.js";const H={class:"top"},J={class:"tree"},K={class:"custom-tree-node"},O={class:"dialog-footer"},P=R({__name:"Building",setup(Q){const a=p(!1),v=p([]),c=async()=>{const t=await U();v.value=I(t.data.list),console.log("楼栋列表",t)};c();const w=async(t,e)=>{z.confirm("是否删除该条节点？",{confirmButtonText:"确认",cancelButtonText:"取消",type:"warning"}).then(async()=>{await D(e.id),m({type:"success",message:"删除成功"}),c()}).catch(()=>{m({type:"info",message:"删除失败"})})},g=p(),n=b({name:"",id:0,pid:0}),k=b({name:[{required:!0,message:"请输入名称",trigger:"blur"}]}),r=p(!1),C=async t=>{n.pid=t.id,a.value=!0,r.value=!1},V=async t=>{r.value=!0,n.name=t.name,n.id=t.id,n.pid=t.pid,a.value=!0},y=()=>{a.value=!0},B=async()=>{if(r.value)(await M(n)).code==1e4&&(m.success("修改成功"),a.value=!1,c());else{const t=await L(n);console.log(t),t.code==1e4&&(m.success("添加成功"),a.value=!1,c())}n.id=0,n.name=""},h=async t=>{t&&await t.validate((e,i)=>{e?B():console.log("error submit!",i)})};return(t,e)=>{const i=u("el-button"),$=u("el-tree"),T=u("el-input"),j=u("el-form-item"),E=u("el-form"),F=u("el-dialog"),N=u("el-card");return q(),S(N,{style:{"max-width":"100vw"}},{default:l(()=>[o("div",H,[s(i,{type:"success",onClick:y},{default:l(()=>[...e[4]||(e[4]=[o("i",{class:"iconfont icon-jia"},null,-1),_("新增楼层",-1)])]),_:1})]),o("div",J,[s($,{style:{"max-width":"600px"},data:v.value,"show-checkbox":"","node-key":"id","expand-on-click-node":!1,props:{label:"name",value:"name",children:"children"}},{default:l(({node:d,data:f})=>[o("div",K,[o("span",null,A(d.label),1),o("div",null,[s(i,{style:{width:"30px",height:"30px"},type:"success",circle:"",onClick:x=>C(f)},{default:l(()=>[...e[5]||(e[5]=[o("i",{class:"iconfont icon-jia"},null,-1)])]),_:1},8,["onClick"]),s(i,{style:{"margin-left":"4px",width:"30px",height:"30px"},type:"primary",circle:"",onClick:x=>V(f)},{default:l(()=>[...e[6]||(e[6]=[o("span",{class:"iconfont icon-bianji"},null,-1)])]),_:1},8,["onClick"]),s(i,{style:{"margin-left":"4px",width:"30px",height:"30px"},circle:"",type:"danger",onClick:x=>w(d,f)},{default:l(()=>[...e[7]||(e[7]=[o("span",{class:"iconfont icon-shanchu"},null,-1)])]),_:1},8,["onClick"])])])]),_:1},8,["data"])]),s(F,{modelValue:a.value,"onUpdate:modelValue":e[3]||(e[3]=d=>a.value=d),title:r.value?"修改楼层":"新增楼层",width:"500","before-close":y},{footer:l(()=>[o("div",O,[s(i,{onClick:e[1]||(e[1]=d=>a.value=!1)},{default:l(()=>[...e[8]||(e[8]=[_("取消",-1)])]),_:1}),s(i,{type:"primary",onClick:e[2]||(e[2]=d=>h(g.value))},{default:l(()=>[...e[9]||(e[9]=[_(" 提交 ",-1)])]),_:1})])]),default:l(()=>[o("div",null,[s(E,{ref_key:"ruleFormRef",ref:g,style:{"max-width":"600px"},model:n,rules:k,"label-width":"auto"},{default:l(()=>[s(j,{label:"名称",prop:"name"},{default:l(()=>[s(T,{modelValue:n.name,"onUpdate:modelValue":e[0]||(e[0]=d=>n.name=d)},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])])]),_:1},8,["modelValue","title"])]),_:1})}}}),Y=G(P,[["__scopeId","data-v-2e1250e8"]]);export{Y as default};
