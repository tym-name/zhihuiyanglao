import{_ as S}from"./Relation.vue_vue_type_script_setup_true_lang-BFgC7YOg.js";import{d as Y,l as G,r as f,k as x,c as H,e as l,N as J,b as d,w as t,g as i,Y as K,n as L,t as C,f as O,U as P,I as k,E as b,h as Q,a as w,_ as W}from"./index-DSXWNbz6.js";const X={class:"dialog-footer"},Z=Y({__name:"Family",props:{familylist:{type:Array,default:()=>[]}},setup(F,{expose:D}){let U=F;G(()=>U.familylist,r=>{r&&(u.value=r,console.log(u.value))});const u=f(P("familyData")||[]),V=f(!1),m=f(!1),g=f(!1),p=f(),c=x({id:0,elderlyId:0,name:"",mobile:"",idCard:"",relation:"",gender:1,address:""}),a=f({...c}),B=x({name:[{required:!0,message:"请输入姓名",trigger:"blur"}],mobile:[{required:!0,message:"请输入联系电话",trigger:"blur"},{pattern:/^1[3-9]\d{9}$/,message:"请输入正确的手机号",trigger:"blur"}],idCard:[{required:!0,message:"请输入身份证号",trigger:"blur"}],relation:[{required:!0,message:"请选择老人关系",trigger:"blur"}],gender:[{required:!0,message:"请选择性别",trigger:"change"}],address:[{required:!0,message:"请输入联系地址",trigger:"blur"}]}),q=()=>{g.value=!1,m.value=!0,a.value={...c},k(()=>{p.value?.clearValidate()})},E=r=>{g.value=!0,m.value=!0,a.value={...r},k(()=>{p.value?.clearValidate()})},I=async()=>{if(p.value)try{if(await p.value.validate(),V.value=!0,g.value){const r=u.value.findIndex(e=>e.id===a.value.id);r>-1&&(u.value[r]={...a.value},b.success("修改家属信息成功"))}else{const r=u.value.length>0?Math.max(...u.value.map(s=>s.id))+1:1,e={...a.value,id:r};u.value.push(e),b.success("新增家属成功")}m.value=!1,a.value={...c}}catch(r){console.error("表单校验失败：",r)}finally{V.value=!1}},N=()=>{m.value=!1,a.value={...c},p.value?.clearValidate()},T=r=>{Q.confirm("确定要删除该家属信息吗？","删除确认",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{u.value=u.value.filter(e=>e.id!==r),b.success("删除成功")}).catch(()=>{b.info("已取消删除")})};return D({data:u}),(r,e)=>{const s=d("el-button"),n=d("el-table-column"),$=d("el-table"),_=d("el-input"),v=d("el-form-item"),y=d("el-radio"),M=d("el-radio-group"),z=d("el-form"),R=d("el-dialog"),j=K("loading");return w(),H("div",null,[l(s,{style:{"margin-bottom":"10px"},type:"primary",onClick:q},{default:t(()=>[...e[7]||(e[7]=[i("新增家属",-1)])]),_:1}),J((w(),L($,{border:"",data:u.value,style:{width:"100%"}},{default:t(()=>[l(n,{prop:"id",label:"序号"}),l(n,{prop:"name",label:"姓名"}),l(n,{label:"性别"},{default:t(o=>[i(C(o.row.gender===1?"男":"女"),1)]),_:1}),l(n,{prop:"idCard",label:"身份证号"}),l(n,{prop:"mobile",label:"联系电话"}),l(n,{prop:"address",label:"联系地址"}),l(n,{prop:"relation",label:"与老人的关系"}),l(n,{fixed:"right",label:"操作"},{default:t(o=>[l(s,{link:"",type:"primary",onClick:A=>E(o.row)},{default:t(()=>[...e[8]||(e[8]=[i(" 编辑 ",-1)])]),_:1},8,["onClick"]),l(s,{link:"",type:"primary",onClick:A=>T(o.row.id)},{default:t(()=>[...e[9]||(e[9]=[i("删除",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])),[[j,V.value]]),l(R,{modelValue:m.value,"onUpdate:modelValue":e[6]||(e[6]=o=>m.value=o),title:g.value?"修改家属":"新增家属",width:"500"},{footer:t(()=>[O("div",X,[l(s,{onClick:N},{default:t(()=>[...e[12]||(e[12]=[i("取消",-1)])]),_:1}),l(s,{type:"primary",onClick:I},{default:t(()=>[i(C(g.value?"确认修改":"确认新增"),1)]),_:1})])]),default:t(()=>[l(z,{ref_key:"ruleFormRef",ref:p,style:{"max-width":"600px"},model:a.value,rules:B,"label-width":"auto"},{default:t(()=>[l(v,{label:"姓名:",prop:"name"},{default:t(()=>[l(_,{modelValue:a.value.name,"onUpdate:modelValue":e[0]||(e[0]=o=>a.value.name=o),placeholder:"请输入姓名"},null,8,["modelValue"])]),_:1}),l(v,{label:"联系电话:",prop:"mobile"},{default:t(()=>[l(_,{modelValue:a.value.mobile,"onUpdate:modelValue":e[1]||(e[1]=o=>a.value.mobile=o),placeholder:"请输入联系电话"},null,8,["modelValue"])]),_:1}),l(v,{label:"身份证号:",prop:"idCard"},{default:t(()=>[l(_,{modelValue:a.value.idCard,"onUpdate:modelValue":e[2]||(e[2]=o=>a.value.idCard=o),placeholder:"请输入身份证号"},null,8,["modelValue"])]),_:1}),l(v,{label:"与老人关系:",prop:"relation"},{default:t(()=>[l(S,{modelValue:a.value.relation,"onUpdate:modelValue":e[3]||(e[3]=o=>a.value.relation=o)},null,8,["modelValue"])]),_:1}),l(v,{label:"性别:",prop:"gender"},{default:t(()=>[l(M,{modelValue:a.value.gender,"onUpdate:modelValue":e[4]||(e[4]=o=>a.value.gender=o)},{default:t(()=>[l(y,{value:1,size:"large"},{default:t(()=>[...e[10]||(e[10]=[i("男",-1)])]),_:1}),l(y,{value:2,size:"large"},{default:t(()=>[...e[11]||(e[11]=[i("女",-1)])]),_:1})]),_:1},8,["modelValue"])]),_:1}),l(v,{label:"联系地址:",prop:"address"},{default:t(()=>[l(_,{modelValue:a.value.address,"onUpdate:modelValue":e[5]||(e[5]=o=>a.value.address=o),placeholder:"请输入联系地址"},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"])])}}}),le=W(Z,[["__scopeId","data-v-6b6b74af"]]);export{le as F};
