import{b as B,e as C}from"./company-2RAv3DgF.js";import{d as z,m as O,i as A,r as P,l as H,k as E,o as J,E as N,c as K,f as s,e as l,b as f,u as o,w as t,N as W,g as n,a as R,O as G,_ as Y,z as L,n as j,P as Q,q as I,s as k,B as x}from"./index-DSXWNbz6.js";import{P as X}from"./Province-DQ3UkAue.js";import{u as T}from"./Uploads-hqb4toZy.js";const Z={class:"ruleForm"},h={class:"ruleForm"},ee={class:"ruleForm"},le={class:"ruleForm"},ae={class:"ruleForm"},oe={class:"ruleForm"},te={class:"ruleForm"},re={class:"ruleForm"},de=z({__name:"Product",props:O({id:{type:[Number],required:!1,default:0}},{modelValue:{default:()=>({name:"",province:"",city:"",cityInfo:{province:"",city:""},address:"",telephone:null,startTime:"",legalPerson:null,mobile:null,creditCode:null,license:0,medicalPoint:0,house:"",certificate:"",picture:"",adminUserName:"",adminPwd:"",adminName:"",adminMobile:""})},modelModifiers:{}}),emits:["update:modelValue"],setup(_,{expose:u}){const U="http://123.57.237.81:8080/caresystem-server/api",v="http://123.57.237.81:8080/caresystem/",y=U+"/upload/add",c=A(_,"modelValue"),m=_,{id:b}=m,a=c,V=P(),F=P();H(()=>a.value.cityInfo,p=>{a.value.province=p.province,a.value.city=p.city},{deep:!0,immediate:!0});const M=E({name:[{required:!0,message:"请输入机构名称",trigger:"blur"}],province:[{required:!0,message:"请选择省市",trigger:"change"}],address:[{required:!0,message:"请输入地址",trigger:"blur"}],telephone:[{required:!0,message:"请输入对外服务电话",trigger:"blur"},{pattern:/^1[3-9]\d{9}$|^\d{3,4}-\d{7,8}$/,message:"请输入正确的电话格式（手机号或座机号）",trigger:"blur"}],adminName:[{required:!0,message:"请输入管理员姓名",trigger:"blur"}],adminMobile:[{required:!0,message:"请输入联系方式",trigger:"blur"},{pattern:/^1[3-9]\d{9}$/,message:"请输入正确的手机号",trigger:"blur"}],adminUserName:[{required:!0,message:"请输入管理员账号",trigger:"blur"}],adminPwd:[{required:!0,message:"请输入密码",trigger:"blur"},{min:6,message:"密码长度不能少于6位",trigger:"blur"}],startTime:[{required:!0,message:"请选择开业时间",trigger:"change"}],legalPerson:[{required:!0,message:"请输入法人代表",trigger:"blur"}],mobile:[{required:!0,message:"请输入法人代表联系号码",trigger:"blur"},{pattern:/^1[3-9]\d{9}$/,message:"请输入正确的手机号",trigger:"blur"}],creditCode:[{required:!0,message:"请输入统一社会信用代码",trigger:"blur"}]}),D=()=>{V.value?.validateField("province")};return J(async()=>{if(b&&b!==0)try{const p=await B(b);console.log("获取机构单条详情",p);const e=p.data;(e.province||e.city)&&(e.cityInfo={province:e.province||"",city:e.city||""}),Object.assign(a.value,e)}catch(p){console.error("获取机构详情失败：",p),N.error("加载机构详情失败，请刷新重试")}else console.log("当前为新增模式，跳过机构详情请求")}),u({submitForm:async()=>{try{return await V.value?.validate(),await F.value?.validate(),console.log("表单提交数据：",a.value),!0}catch(p){return console.error("表单校验失败：",p),!1}}}),(p,e)=>{const i=f("el-input"),d=f("el-form-item"),S=f("el-date-picker"),q=f("el-form"),g=f("el-radio"),w=f("el-radio-group"),$=f("el-button");return R(),K("div",null,[e[27]||(e[27]=s("div",{class:"Nowiln"},[s("div",{class:"left"}),s("div",{class:"title"},"基础信息")],-1)),l(q,{ref_key:"ruleFormRef",ref:V,model:o(a),rules:M,"label-width":"auto"},{default:t(()=>[s("div",Z,[l(d,{label:"机构名称",prop:"name"},{default:t(()=>[l(i,{modelValue:o(a).name,"onUpdate:modelValue":e[0]||(e[0]=r=>o(a).name=r),placeholder:"请输入机构名称"},null,8,["modelValue"])]),_:1}),l(d,{class:"formitem",label:"选择省份"},{default:t(()=>[l(X,{modelValue:o(a).cityInfo,"onUpdate:modelValue":e[1]||(e[1]=r=>o(a).cityInfo=r),onChange:D},null,8,["modelValue"])]),_:1})]),W(l(d,{prop:"province"},{default:t(()=>[l(i,{modelValue:o(a).province,"onUpdate:modelValue":e[2]||(e[2]=r=>o(a).province=r)},null,8,["modelValue"])]),_:1},512),[[G,!1]]),s("div",h,[l(d,{label:"地址",prop:"address"},{default:t(()=>[l(i,{modelValue:o(a).address,"onUpdate:modelValue":e[3]||(e[3]=r=>o(a).address=r),placeholder:"请输入地址"},null,8,["modelValue"])]),_:1}),l(d,{class:"formitem",label:"对外服务电话",prop:"telephone"},{default:t(()=>[l(i,{modelValue:o(a).telephone,"onUpdate:modelValue":e[4]||(e[4]=r=>o(a).telephone=r),placeholder:"请输入对外服务电话"},null,8,["modelValue"])]),_:1})]),s("div",ee,[l(d,{label:"管理员姓名",prop:"adminName"},{default:t(()=>[l(i,{modelValue:o(a).adminName,"onUpdate:modelValue":e[5]||(e[5]=r=>o(a).adminName=r),placeholder:"请输入管理员姓名"},null,8,["modelValue"])]),_:1}),l(d,{class:"formitem",label:"联系方式",prop:"adminMobile"},{default:t(()=>[l(i,{modelValue:o(a).adminMobile,"onUpdate:modelValue":e[6]||(e[6]=r=>o(a).adminMobile=r),placeholder:"请输入联系方式"},null,8,["modelValue"])]),_:1})]),s("div",le,[l(d,{label:"管理员账号",prop:"adminUserName"},{default:t(()=>[l(i,{modelValue:o(a).adminUserName,"onUpdate:modelValue":e[7]||(e[7]=r=>o(a).adminUserName=r),placeholder:"请输入管理员账号"},null,8,["modelValue"])]),_:1}),l(d,{class:"formitem",label:"密码",prop:"adminPwd"},{default:t(()=>[l(i,{type:"password",modelValue:o(a).adminPwd,"onUpdate:modelValue":e[8]||(e[8]=r=>o(a).adminPwd=r),placeholder:"请输入密码"},null,8,["modelValue"])]),_:1})]),l(d,{label:"开业时间",prop:"startTime"},{default:t(()=>[l(S,{style:{width:"428px"},modelValue:o(a).startTime,"onUpdate:modelValue":e[9]||(e[9]=r=>o(a).startTime=r),type:"datetime",placeholder:"请选择",format:"YYYY-MM-DD HH:mm","value-format":"YYYY-MM-DD HH:mm"},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"]),e[28]||(e[28]=s("div",{class:"Nowiln"},[s("div",{class:"left"}),s("div",{class:"title"},"经营信息")],-1)),l(q,{ref_key:"ruleFormRef2",ref:F,model:o(a),rules:M,"label-width":"auto"},{default:t(()=>[s("div",ae,[l(d,{label:"法人代表",prop:"legalPerson"},{default:t(()=>[l(i,{modelValue:o(a).legalPerson,"onUpdate:modelValue":e[10]||(e[10]=r=>o(a).legalPerson=r),placeholder:"请输入法人代表"},null,8,["modelValue"])]),_:1}),l(d,{class:"formitem",label:"法人代表联系号码",prop:"mobile"},{default:t(()=>[l(i,{modelValue:o(a).mobile,"onUpdate:modelValue":e[11]||(e[11]=r=>o(a).mobile=r),placeholder:"请输入法人代表联系号码"},null,8,["modelValue"])]),_:1})]),s("div",oe,[l(d,{label:"统一社会信用代码",prop:"creditCode"},{default:t(()=>[l(i,{modelValue:o(a).creditCode,"onUpdate:modelValue":e[12]||(e[12]=r=>o(a).creditCode=r),placeholder:"请输入统一社会信用代码"},null,8,["modelValue"])]),_:1}),l(d,{class:"FormWrap",label:"卫生许可证:"},{default:t(()=>[l(w,{modelValue:o(a).license,"onUpdate:modelValue":e[13]||(e[13]=r=>o(a).license=r)},{default:t(()=>[l(g,{value:0,size:"large"},{default:t(()=>[...e[18]||(e[18]=[n("是",-1)])]),_:1}),l(g,{value:1,size:"large"},{default:t(()=>[...e[19]||(e[19]=[n("否",-1)])]),_:1})]),_:1},8,["modelValue"])]),_:1})]),s("div",te,[l(d,{class:"radio",label:"是否具备医疗定点资格:"},{default:t(()=>[l(w,{modelValue:o(a).medicalPoint,"onUpdate:modelValue":e[14]||(e[14]=r=>o(a).medicalPoint=r)},{default:t(()=>[l(g,{value:0,size:"large"},{default:t(()=>[...e[20]||(e[20]=[n("是",-1)])]),_:1}),l(g,{value:1,size:"large"},{default:t(()=>[...e[21]||(e[21]=[n("否",-1)])]),_:1})]),_:1},8,["modelValue"])]),_:1}),l(d,{class:"FormWrap",label:"房屋性质:"},{default:t(()=>[l(w,{modelValue:o(a).house,"onUpdate:modelValue":e[15]||(e[15]=r=>o(a).house=r)},{default:t(()=>[l(g,{value:"0",size:"large"},{default:t(()=>[...e[22]||(e[22]=[n("自有产权",-1)])]),_:1}),l(g,{value:"1",size:"large"},{default:t(()=>[...e[23]||(e[23]=[n("租赁",-1)])]),_:1}),l(g,{value:"2",size:"large"},{default:t(()=>[...e[24]||(e[24]=[n("合作使用",-1)])]),_:1}),l(g,{value:"3",size:"large"},{default:t(()=>[...e[25]||(e[25]=[n("其他",-1)])]),_:1})]),_:1},8,["modelValue"])]),_:1})]),s("div",re,[l(d,{class:"radio",label:"营业执照"},{default:t(()=>[l(T,{modelValue:o(a).picture,"onUpdate:modelValue":e[16]||(e[16]=r=>o(a).picture=r),baseUrl:o(v),uploadUrl:y},null,8,["modelValue","baseUrl"])]),_:1}),l(d,{class:"FormWraps",label:"上传图片"},{default:t(()=>[l(T,{modelValue:o(a).certificate,"onUpdate:modelValue":e[17]||(e[17]=r=>o(a).certificate=r),baseUrl:o(v),uploadUrl:y,isText:!0},{"upload-text":t(()=>[l($,{type:"primary"},{default:t(()=>[...e[26]||(e[26]=[n("上传图片",-1)])]),_:1})]),_:1},8,["modelValue","baseUrl"])]),_:1})])]),_:1},8,["model","rules"])])}}}),se=Y(de,[["__scopeId","data-v-9c0661a6"]]),ue={class:"substr"},ie=z({__name:"CompanyAdd",setup(_){let u=E({name:"",province:"",cityInfo:{province:"",city:""},city:"",address:"",telephone:null,startTime:null,legalPerson:null,mobile:null,creditCode:null,license:0,medicalPoint:0,house:null,certificate:"",picture:"",adminUserName:"",adminPwd:"",adminName:"",adminMobile:"",id:0});const U=L(),v=P(U.query.id),y=async()=>{if(u.id){let c=await I();u.adminPwd=k.sm2.doEncrypt(u.adminPwd,c.data),await C(JSON.parse(JSON.stringify(u))),N.success("机构修改成功！"),x.push("/company")}else{let c=await I();u.adminPwd=k.sm2.doEncrypt(u.adminPwd,c.data),await C(JSON.parse(JSON.stringify(u))),N.success("机构新增成功！"),x.push("/company")}};return(c,m)=>{const b=f("el-button"),a=f("el-card");return R(),j(a,null,{default:t(()=>[l(se,{modelValue:o(u),"onUpdate:modelValue":m[0]||(m[0]=V=>Q(u)?u.value=V:u=V),id:v.value},null,8,["modelValue","id"]),s("div",ue,[l(b,{onClick:m[1]||(m[1]=V=>c.$router.push("/company"))},{default:t(()=>[...m[2]||(m[2]=[n("取消",-1)])]),_:1}),l(b,{type:"primary",onClick:y},{default:t(()=>[...m[3]||(m[3]=[n("保存",-1)])]),_:1})])]),_:1})}}}),ce=Y(ie,[["__scopeId","data-v-c7a98976"]]);export{ce as default};
