import{T as M}from"./table-BDVlGf5e.js";import{_ as z,e as H,f as J}from"./ChoseOneElderly.vue_vue_type_script_setup_true_lang-DVl0-9Mk.js";import{D as C,d as w,r as i,k as K,j as Q,l as O,b as p,c as T,a as $,e as l,w as o,n as W,t as X,g,f as A,h as D,E as I,u as Y}from"./index-DSXWNbz6.js";import"./activity-DcouU_la.js";const Z=n=>C.get("/checkRoom/list",n),ee=n=>C.delete(`/checkRoom/delete/${n}`),le=n=>C.post("/checkRoom/deleteAll",n),te=n=>C.post("/checkRoom/add",n),ae=n=>C.put("/checkRoom/update",n),oe=n=>C.get(`/checkRoom/get/${n}`),re={class:"dialog-footer"},ue=w({__name:"AddOrUpdateCheckRoom",props:{isShow:{type:Boolean},OpenOrClose:{type:Function},oneCheckRoomData:{},refresh:{type:Function}},setup(n){const m=n,c=i(),f=i(!1),b=i(""),e=i({id:0,elderlyId:null,spirit:"",diet:"",sleep:"",shit:"",urinate:"",communicate:"",memory:"",temperature:"",pulse:"",breathe:"",blood:"",suggest:""}),B=K({elderlyId:[{required:!0,message:"请选择老人姓名",trigger:["change","blur"]}],spirit:[{required:!0,message:"请输入精神状态",trigger:["change","blur"]},{pattern:/^(正常|异常)$/,message:"请输入“正常”或“异常”",trigger:"blur"}],diet:[{required:!0,message:"请输入饮食状态",trigger:["change","blur"]},{pattern:/^(正常|异常)$/,message:"请输入“正常”或“异常”",trigger:"blur"}],sleep:[{required:!0,message:"请输入睡眠状态",trigger:["change","blur"]},{pattern:/^(正常|异常)$/,message:"请输入“正常”或“异常”",trigger:"blur"}],shit:[{required:!0,message:"请输入大便状态",trigger:["change","blur"]},{pattern:/^(正常|异常)$/,message:"请输入“正常”或“异常”",trigger:"blur"}],urinate:[{required:!0,message:"请输入小便状态",trigger:["change","blur"]},{pattern:/^(正常|异常)$/,message:"请输入“正常”或“异常”",trigger:"blur"}],communicate:[{required:!0,message:"请输入交流状态",trigger:["change","blur"]},{pattern:/^(正常|异常)$/,message:"请输入“正常”或“异常”",trigger:"blur"}],memory:[{required:!0,message:"请输入记忆状态",trigger:["change","blur"]},{pattern:/^(正常|异常)$/,message:"请输入“正常”或“异常”",trigger:"blur"}],temperature:[{required:!0,message:"请输入体温状态",trigger:["change","blur"]},{pattern:/^(正常|异常)$/,message:"请输入“正常”或“异常”",trigger:"blur"}],pulse:[{required:!0,message:"请输入脉搏状态",trigger:["change","blur"]},{pattern:/^(正常|异常)$/,message:"请输入“正常”或“异常”",trigger:"blur"}],breathe:[{required:!0,message:"请输入呼吸状态",trigger:["change","blur"]},{pattern:/^(正常|异常)$/,message:"请输入“正常”或“异常”",trigger:"blur"}],blood:[{required:!0,message:"请输入血压状态",trigger:["change","blur"]},{pattern:/^(正常|异常)$/,message:"请输入“正常”或“异常”",trigger:"blur"}],suggest:[{required:!0,message:"请输入医生建议",trigger:["change","blur"]}]}),S=Q(()=>e.value.id?"修改医生查房记录记录":"增加医生查房记录"),N=r=>{D.confirm("你确定要关闭此对话框吗?").then(()=>{r()}).catch(()=>{})},_=()=>{f.value=!0},U=()=>{f.value=!1},x=r=>{b.value=r.name,e.value.elderlyId=r.id,f.value=!1,c.value?.validateField("elderlyId")};O(()=>m.oneCheckRoomData,r=>{m.isShow&&r.id>0&&(b.value=r.elderlyName,e.value.id=r.id,e.value.elderlyId=r.elderlyId,e.value.spirit=r.spirit,e.value.diet=r.diet,e.value.sleep=r.sleep,e.value.shit=r.shit,e.value.urinate=r.urinate,e.value.communicate=r.communicate,e.value.memory=r.memory,e.value.temperature=r.temperature,e.value.pulse=r.pulse,e.value.breathe=r.breathe,e.value.blood=r.blood,e.value.suggest=r.suggest)},{immediate:!0,deep:!0});const q=async()=>{c.value&&await c.value.validate(async r=>{if(r){if(e.value.id){if(!await ae(e.value))return;I.success("修改成功")}else{if(!await te(e.value))return;I.success("添加成功")}m.OpenOrClose(),m.refresh(),v()}})},v=()=>{c.value?.resetFields(),b.value="",e.value={id:0,elderlyId:null,spirit:"",diet:"",sleep:"",shit:"",urinate:"",communicate:"",memory:"",temperature:"",pulse:"",breathe:"",blood:"",suggest:""}};return O(()=>m.isShow,r=>{r||v()}),(r,a)=>{const h=p("el-button"),s=p("el-form-item"),d=p("el-input"),V=p("el-form"),F=p("el-dialog");return $(),T("div",null,[l(F,{modelValue:m.isShow,"onUpdate:modelValue":a[12]||(a[12]=t=>m.isShow=t),title:S.value,width:"500","before-close":N},{footer:o(()=>[A("div",re,[l(h,{onClick:m.OpenOrClose},{default:o(()=>[...a[14]||(a[14]=[g("取消",-1)])]),_:1},8,["onClick"]),l(h,{type:"primary",onClick:q},{default:o(()=>[...a[15]||(a[15]=[g("确认",-1)])]),_:1})])]),default:o(()=>[l(V,{ref_key:"ruleFormRef",ref:c,style:{"max-width":"600px"},model:e.value,rules:B,"label-width":"auto"},{default:o(()=>[l(s,{label:"老人姓名",prop:"elderlyId"},{default:o(()=>[e.value.elderlyId&&e.value.elderlyId>0?($(),T("span",{key:0,onClick:_},X(b.value),1)):($(),W(h,{key:1,type:"primary",onClick:_},{default:o(()=>[...a[13]||(a[13]=[g("选择老人",-1)])]),_:1}))]),_:1}),l(s,{label:"精神",prop:"spirit"},{default:o(()=>[l(d,{modelValue:e.value.spirit,"onUpdate:modelValue":a[0]||(a[0]=t=>e.value.spirit=t),placeholder:"请输入精神"},null,8,["modelValue"])]),_:1}),l(s,{label:"饮食",prop:"diet"},{default:o(()=>[l(d,{modelValue:e.value.diet,"onUpdate:modelValue":a[1]||(a[1]=t=>e.value.diet=t),placeholder:"请输入饮食"},null,8,["modelValue"])]),_:1}),l(s,{label:"睡眠",prop:"sleep"},{default:o(()=>[l(d,{modelValue:e.value.sleep,"onUpdate:modelValue":a[2]||(a[2]=t=>e.value.sleep=t),placeholder:"请输入睡眠"},null,8,["modelValue"])]),_:1}),l(s,{label:"大便",prop:"shit"},{default:o(()=>[l(d,{modelValue:e.value.shit,"onUpdate:modelValue":a[3]||(a[3]=t=>e.value.shit=t),placeholder:"请输入大便"},null,8,["modelValue"])]),_:1}),l(s,{label:"小便",prop:"urinate"},{default:o(()=>[l(d,{modelValue:e.value.urinate,"onUpdate:modelValue":a[4]||(a[4]=t=>e.value.urinate=t),placeholder:"请输入小便"},null,8,["modelValue"])]),_:1}),l(s,{label:"交流",prop:"communicate"},{default:o(()=>[l(d,{modelValue:e.value.communicate,"onUpdate:modelValue":a[5]||(a[5]=t=>e.value.communicate=t),placeholder:"请输入交流"},null,8,["modelValue"])]),_:1}),l(s,{label:"记忆",prop:"memory"},{default:o(()=>[l(d,{modelValue:e.value.memory,"onUpdate:modelValue":a[6]||(a[6]=t=>e.value.memory=t),placeholder:"请输入记忆"},null,8,["modelValue"])]),_:1}),l(s,{label:"体温",prop:"temperature"},{default:o(()=>[l(d,{modelValue:e.value.temperature,"onUpdate:modelValue":a[7]||(a[7]=t=>e.value.temperature=t),placeholder:"请输入体温"},null,8,["modelValue"])]),_:1}),l(s,{label:"脉搏",prop:"pulse"},{default:o(()=>[l(d,{modelValue:e.value.pulse,"onUpdate:modelValue":a[8]||(a[8]=t=>e.value.pulse=t),placeholder:"请输入脉搏"},null,8,["modelValue"])]),_:1}),l(s,{label:"呼吸",prop:"breathe"},{default:o(()=>[l(d,{modelValue:e.value.breathe,"onUpdate:modelValue":a[9]||(a[9]=t=>e.value.breathe=t),placeholder:"请输入呼吸"},null,8,["modelValue"])]),_:1}),l(s,{label:"血压",prop:"blood"},{default:o(()=>[l(d,{modelValue:e.value.blood,"onUpdate:modelValue":a[10]||(a[10]=t=>e.value.blood=t),placeholder:"请输入血压"},null,8,["modelValue"])]),_:1}),l(s,{label:"医生建议",prop:"suggest"},{default:o(()=>[l(d,{modelValue:e.value.suggest,"onUpdate:modelValue":a[11]||(a[11]=t=>e.value.suggest=t),placeholder:"请输入医生建议"},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"]),l(z,{isShow:f.value,openElderly:_,closeElderly:U,onSelectElderly:x},null,8,["isShow"])])}}}),me=w({__name:"CheckRoom",setup(n){const m=i(!1),c=()=>{m.value=!m.value,s.value={id:0,companyId:null,elderlyId:null,addTime:"",addAccountId:0,spirit:"",diet:"",sleep:"",shit:"",urinate:"",communicate:"",memory:"",temperature:"",pulse:"",breathe:"",blood:"",description:null,suggest:null,begId:0,begName:null,idCard:null,addAccountName:"",addAccountPhoto:null,elderlyName:"",elderlyPhoto:null,elderlyGender:null,elderlyIdCard:null,houseName:null,buildingName:"",staffId:0,staffName:"",staffPhoto:""}},f=i(null),b=()=>{f.value.refresh()},e=t=>{D.confirm("是否删除该条记录？",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(async()=>{await ee(t),I({type:"success",message:"删除成功"}),b()})},B=i(!0),S=i([]),N=i([]),_=t=>{S.value=t,N.value=t.map(u=>u.id),B.value=t.length===0},U=async()=>{D.confirm("是否删除多条记录？",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(async()=>{let t=await le(N.value);console.log(t),t.code===1e4&&(I({type:"success",message:"删除成功"}),b())}).catch(()=>{I({type:"info",message:"取消删除"})})},x=()=>{f.value.refresh()},q=[{type:"selection",width:"50"},{label:"序号",prop:"id"},{label:"记录时间",prop:"addTime"},{label:"记录人",prop:"addAccountName"},{label:"老人姓名",prop:"elderlyName"},{label:"床位",prop:"begName"},{label:"操作",width:160,slot:"operate",fixed:"right"}],v=i({name:"",begId:null}),r=()=>{x()},a=()=>{v.value={name:"",begId:null},h.value=[]},h=i([]);O(()=>h.value,t=>{v.value.begId=t[t.length-1]});const s=i({id:0,companyId:null,elderlyId:null,addTime:"",addAccountId:0,spirit:"",diet:"",sleep:"",shit:"",urinate:"",communicate:"",memory:"",temperature:"",pulse:"",breathe:"",blood:"",description:null,suggest:null,begId:0,begName:null,idCard:null,addAccountName:"",addAccountPhoto:null,elderlyName:"",elderlyPhoto:null,elderlyGender:null,elderlyIdCard:null,houseName:null,buildingName:"",staffId:0,staffName:"",staffPhoto:""}),d=async t=>{c();let u=await oe(t);console.log("获取单条数据",u),u&&u.data&&(s.value=u.data)},V=i([]);return(async()=>{try{let t=await H();console.log("楼栋列表",t);const u=t.data.list||[];V.value=J(u)}catch(t){console.error("获取床位数据失败：",t),V.value=[]}})(),(t,u)=>{const E=p("el-input"),R=p("el-form-item"),P=p("el-cascader"),L=p("el-date-picker"),y=p("el-button"),j=p("el-form");return $(),T("div",null,[l(M,{ref_key:"tableRef",ref:f,columns:q,"fetch-data":Y(Z),"init-params":v.value,onSelectionChange:_},{search:o(()=>[l(j,{inline:!0,class:"demo-form-inline"},{default:o(()=>[l(R,{label:"老人:"},{default:o(()=>[l(E,{placeholder:"请输入老人姓名",clearable:"",modelValue:v.value.name,"onUpdate:modelValue":u[0]||(u[0]=k=>v.value.name=k)},null,8,["modelValue"])]),_:1}),l(R,{label:"床位:"},{default:o(()=>[l(P,{modelValue:h.value,"onUpdate:modelValue":u[1]||(u[1]=k=>h.value=k),options:V.value,clearable:"",placeholder:"请选择床位"},null,8,["modelValue","options"])]),_:1}),l(R,{label:"巡检时间:"},{default:o(()=>[l(L,{type:"daterange","range-separator":"-","start-placeholder":"开始日期","end-placeholder":"结束日期",style:{width:"240px"}})]),_:1}),l(R,null,{default:o(()=>[l(y,{type:"primary",onClick:r},{default:o(()=>[...u[2]||(u[2]=[g("查询",-1)])]),_:1}),l(y,{onClick:a},{default:o(()=>[...u[3]||(u[3]=[g("重置",-1)])]),_:1})]),_:1})]),_:1})]),buttons:o(()=>[l(y,{type:"success",onClick:c},{default:o(()=>[...u[4]||(u[4]=[g("增加",-1)])]),_:1}),l(y,{type:"danger",onClick:U},{default:o(()=>[...u[5]||(u[5]=[g("批量删除",-1)])]),_:1})]),operate:o(({row:k})=>[l(y,{link:"",type:"primary",onClick:G=>d(k.id)},{default:o(()=>[...u[6]||(u[6]=[A("i",{class:"iconfont icon-bianji"},null,-1),g(" 编辑 ",-1)])]),_:1},8,["onClick"]),l(y,{link:"",type:"danger",onClick:G=>e(k.id)},{default:o(()=>[...u[7]||(u[7]=[A("i",{class:"iconfont icon-shanchu"},null,-1),g(" 删除 ",-1)])]),_:1},8,["onClick"])]),_:1},8,["fetch-data","init-params"]),l(ue,{refresh:b,OpenOrClose:c,isShow:m.value,oneCheckRoomData:s.value},null,8,["isShow","oneCheckRoomData"])])}}});export{me as default};
