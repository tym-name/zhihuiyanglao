import{T as Q}from"./table-BDVlGf5e.js";import{b as R,e as j}from"./elderly-p1gfo6w8.js";import{d as q,r,n as O,w as a,u as X,E as g,e as n,f as v,g as d,b as c,c as G,v as H,F as J,t as K,a as D,B as C,h as B,_ as W}from"./index-DSXWNbz6.js";import{c as Z,a as P}from"./customer-s1odyxDc.js";const ee=q({__name:"Customer",setup(le){const b=r(null),_=r(!0),i=r({name:"",idCard:"",begId:0,state:null,date:""}),E=(l,e)=>{e.date||(e.date=[]),e.date[0]=l[0],e.date[1]=l[1],e.startTime=l[0],e.beginDate=l[0],e.endDate=l[1]},x=r([]),w=r({page:1,pageSize:10});(async()=>{try{let l=await R(w.value);console.log("床位列表",l),x.value=l.data.list||[],T.value=I(x.value)}catch(l){console.error("获取床位列表失败：",l),g.error("获取床位数据失败，请稍后重试")}})();const T=r([]),I=l=>{const e=new Map;l.forEach(o=>{e.set(o.id,o)});const s=[];return l.filter(o=>o.pid===0).forEach(o=>{const m={value:o.id,label:o.name,children:[]},y=l.filter(u=>u.pid===o.id);y.forEach(u=>{const f={value:u.id,label:u.name,children:[]},t=l.filter(p=>p.pid===u.id);t.forEach(p=>{f.children.push({value:p.id,label:p.name})}),(f.children.length>0||t.length>0)&&m.children.push(f)}),(m.children.length>0||y.length>0)&&s.push(m)}),s},L=()=>{C.push({path:"/Question"})},M=()=>{b.value?.refresh()},N=[{type:"selection",width:"50"},{label:"序号",prop:"id",width:"100px"},{label:"老人姓名",prop:"name"},{label:"性别",prop:"state",slot:"gender"},{label:"身份证",prop:"idCard",width:180},{label:"来源渠道",prop:"source"},{label:"创建时间",prop:"addTime",width:180},{label:"状态",prop:"stateName"},{label:"操作",slot:"operate",width:400}],$=[{value:"1",label:"未签约"},{value:"2",label:"预定中"},{value:"3",label:"已住院"}],U=()=>{C.push("/Customer-add")},V=r(),S=l=>{console.log("点击修改老人",l),V.value=l,C.push(`/CustomerUpd?id=${l.id}`)},Y=l=>{C.push(`/CustomerParticulars?id=${l.id}`)},A=l=>{B.confirm("是否删除该条记录？",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(async()=>{await P(l),g({type:"success",message:"删除成功"}),b.value?.refresh()}).catch(()=>{g({type:"info",message:"已取消删除"})})},h=r([]),z=()=>{h.value.length!==0&&B.confirm(`是否删除选中的 ${h.value.length} 条记录？`,{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(async()=>{const l=h.value.map(e=>e.id);await j(l),g({type:"success",message:"批量删除成功"}),b.value?.getData(),_.value=!0}).catch(()=>{g({type:"info",message:"已取消删除"})})},F=l=>{console.log("选中的数据：",l),h.value=l,_.value=l.length===0};return(l,e)=>{const s=c("el-button"),k=c("el-input"),o=c("el-form-item"),m=c("el-date-picker"),y=c("el-option"),u=c("el-select"),f=c("el-form");return D(),O(Q,{ref_key:"tableRef",ref:b,onSelectionChange:F,"init-params":i.value,columns:N,"fetch-data":X(Z)},{buttons:a(()=>[n(s,{type:"primary",onClick:U},{default:a(()=>[...e[5]||(e[5]=[d("新增潜在客户",-1)])]),_:1}),n(s,{type:"danger",onClick:z,disabled:_.value},{default:a(()=>[...e[6]||(e[6]=[v("i",{class:"iconfont icon-shanchu"},null,-1),d("批量删除",-1)])]),_:1},8,["disabled"]),n(s,null,{default:a(()=>[...e[7]||(e[7]=[d("EXCEL导入",-1)])]),_:1})]),gender:a(({row:t})=>[d(K(t.gender===1?"男":"女"),1)]),search:a(()=>[n(f,{inline:!0,class:"demo-form-inline",style:{height:"80px"}},{default:a(()=>[n(o,{label:"老人姓名:"},{default:a(()=>[n(k,{placeholder:"请输入老人姓名",modelValue:i.value.name,"onUpdate:modelValue":e[0]||(e[0]=t=>i.value.name=t),clearable:""},null,8,["modelValue"])]),_:1}),n(o,{label:"身份证号:"},{default:a(()=>[n(k,{placeholder:"请输入身份证号",modelValue:i.value.idCard,"onUpdate:modelValue":e[1]||(e[1]=t=>i.value.idCard=t),clearable:""},null,8,["modelValue"])]),_:1}),n(o,{label:"创建日期:"},{default:a(()=>[n(m,{type:"daterange","value-format":"YYYY-MM-DD","range-separator":"-","start-placeholder":"开始时间","end-placeholder":"结束时间",style:{width:"200px"},size:"default",onChange:e[2]||(e[2]=t=>E(t,i.value)),modelValue:i.value.date,"onUpdate:modelValue":e[3]||(e[3]=t=>i.value.date=t)},null,8,["modelValue"])]),_:1}),n(o,{label:"状态:"},{default:a(()=>[n(u,{placeholder:"请选择",modelValue:i.value.state,"onUpdate:modelValue":e[4]||(e[4]=t=>i.value.state=t),style:{width:"200px"}},{default:a(()=>[(D(),G(J,null,H($,t=>n(y,{key:t.value,label:t.label,value:t.value},null,8,["label","value"])),64))]),_:1},8,["modelValue"])]),_:1}),n(o,null,{default:a(()=>[n(s,{type:"primary",onClick:M},{default:a(()=>[...e[8]||(e[8]=[d("查询",-1)])]),_:1}),n(s,null,{default:a(()=>[...e[9]||(e[9]=[d("重置",-1)])]),_:1})]),_:1})]),_:1})]),operate:a(({row:t})=>[n(s,{link:"",type:"primary",onClick:p=>Y(t)},{default:a(()=>[...e[10]||(e[10]=[v("i",{class:"iconfont icon-file"},null,-1),d("详情",-1)])]),_:1},8,["onClick"]),n(s,{link:"",type:"primary",onClick:p=>S(t),oldhome:V.value},{default:a(()=>[...e[11]||(e[11]=[v("i",{class:"iconfont icon-bianji"},null,-1),d("编辑",-1)])]),_:1},8,["onClick","oldhome"]),n(s,{link:"",type:"primary",onClick:L},{default:a(()=>[...e[12]||(e[12]=[v("i",{class:"iconfont icon-xiangqing"},null,-1),d("咨询登记",-1)])]),_:1}),n(s,{link:"",type:"danger",onClick:p=>A(t.id)},{default:a(()=>[...e[13]||(e[13]=[v("i",{class:"iconfont icon-shanchu"},null,-1),d("删除",-1)])]),_:1},8,["onClick"])]),_:1},8,["init-params","fetch-data"])}}}),ie=W(ee,[["__scopeId","data-v-3d6d822f"]]);export{ie as default};
