import{d as P,z as $,r as m,k as i,c as p,e as l,f as h,w as r,b as d,F as _,E as b,B as N,n as g,u as E,y as J,v as k,g as c,a as s,_ as O}from"./index-DSXWNbz6.js";import{d as H}from"./personel-C8BKxqDq.js";import{r as K}from"./position-BwEY5D3f.js";import{c as Q,d as W}from"./staff-DkaIM1g7.js";const X=["src"],Y={id:"div"},Z="http://123.57.237.81:8080/caresystem/",ee=P({__name:"AddStaff",setup(te){const v=$(),y=v.params.id?Number(v.params.id):0,f=m(),t=i({id:0,companyId:0,photo:"",name:"",mobile:"",isCarer:0,addAccountId:0,addAccountName:"",addTime:"",departmentName:"",roles:[],adminId:0,adminUserName:"",adminPwd:"",enable:"",idCard:"",roleId:"",departmentId:""}),F=m(""),A=o=>{o&&(F.value=URL.createObjectURL(o.raw))},L=o=>o.type!=="image/jpeg"?(b.error("Avatar picture must be JPG format!"),!1):o.size/1024/1024>2?(b.error("Avatar picture size can not exceed 2MB!"),!1):!0,q=i({photo:{required:!0,message:"请添加图片",trigger:"blur"},name:{required:!0,message:"请输入员工姓名",trigger:"blur"},mobile:{required:!0,message:"请输入手机号",trigger:"blur"},idCard:{required:!0,message:"请输入身份证号",trigger:"blur"},departmentId:{required:!0,message:"请选择部门",trigger:"blur"},roleId:{required:!0,message:"请选择岗位",trigger:"change"},adminUserName:{required:!0,message:"请输入账号",trigger:"blur"},enable:{required:!0,message:"请选择",trigger:"blur"}}),B=i({id:0,companyId:0,name:"",pid:0}),V=m([]);(async()=>{const o=await H(B);console.log("所属部门",o),V.value=o.data.list})();const I=m([]),R=i({id:0,name:"",companyId:0,addAccountId:0,addAccountName:"",addTime:"",accountCounts:0,menuIds:[]});(async()=>{const o=await K(R);console.log("所属岗位",o),I.value=o.data.list})(),(async()=>{if(y===0)return;const e=(await Q(y)).data;t.photo=e.photo,t.name=e.name,t.mobile=e.mobile,t.idCard=e.idCard,t.departmentId=e.departmentId,t.adminUserName=e.adminUserName,t.enable=e.enable})();const S=async o=>{o&&await o.validate(async e=>{e&&(await W(t),b.success("修改成功"),o.resetFields(),N.back())})},T=o=>{o&&(o.resetFields(),N.back())};return(o,e)=>{const z=d("el-icon"),D=d("el-upload"),n=d("el-form-item"),u=d("el-input"),U=d("el-option"),w=d("el-select"),x=d("el-radio"),G=d("el-radio-group"),M=d("el-form"),j=d("el-card"),C=d("el-button");return s(),p(_,null,[l(j,null,{default:r(()=>[l(M,{ref_key:"ruleFormRef",ref:f,style:{"max-width":"600px"},model:t,rules:q,"label-width":"auto"},{default:r(()=>[l(n,{label:"员工头像",prop:"photo"},{default:r(()=>[l(D,{class:"avatar-uploader","on-success":A,"before-upload":L},{default:r(()=>[t.photo?(s(),p("img",{key:0,src:Z+t.photo,class:"avatar",style:{width:"100px",height:"100px"}},null,8,X)):(s(),g(z,{key:1,class:"avatar-uploader-icon"},{default:r(()=>[l(E(J))]),_:1}))]),_:1})]),_:1}),l(n,{label:"员工姓名",prop:"name"},{default:r(()=>[l(u,{modelValue:t.name,"onUpdate:modelValue":e[0]||(e[0]=a=>t.name=a),style:{width:"308px"}},null,8,["modelValue"])]),_:1}),l(n,{label:"联系方式",prop:"mobile"},{default:r(()=>[l(u,{modelValue:t.mobile,"onUpdate:modelValue":e[1]||(e[1]=a=>t.mobile=a),style:{width:"308px"}},null,8,["modelValue"])]),_:1}),l(n,{label:"身份证号",prop:"idCard"},{default:r(()=>[l(u,{modelValue:t.idCard,"onUpdate:modelValue":e[2]||(e[2]=a=>t.idCard=a),style:{width:"308px"}},null,8,["modelValue"])]),_:1}),l(n,{label:"所属部门",prop:"departmentId"},{default:r(()=>[l(w,{modelValue:t.departmentId,"onUpdate:modelValue":e[3]||(e[3]=a=>t.departmentId=a),placeholder:"请选择部门",clearable:"",style:{width:"308px"}},{default:r(()=>[(s(!0),p(_,null,k(V.value,a=>(s(),g(U,{key:a,label:a.name,value:a.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),l(n,{label:"所属岗位",prop:"roleId"},{default:r(()=>[l(w,{modelValue:t.roleId,"onUpdate:modelValue":e[4]||(e[4]=a=>t.roleId=a),placeholder:"请选择岗位",clearable:"",style:{width:"308px"}},{default:r(()=>[(s(!0),p(_,null,k(I.value,a=>(s(),g(U,{key:a,label:a.name,value:a.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),l(n,{label:"账号",prop:"adminUserName"},{default:r(()=>[l(u,{modelValue:t.adminUserName,"onUpdate:modelValue":e[5]||(e[5]=a=>t.adminUserName=a),style:{width:"308px"}},null,8,["modelValue"])]),_:1}),l(n,{label:"是否是护工",prop:"enable"},{default:r(()=>[l(G,{modelValue:t.enable,"onUpdate:modelValue":e[6]||(e[6]=a=>t.enable=a)},{default:r(()=>[l(x,{value:1},{default:r(()=>[...e[9]||(e[9]=[c("是",-1)])]),_:1}),l(x,{value:0},{default:r(()=>[...e[10]||(e[10]=[c("否",-1)])]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1}),h("div",Y,[l(C,{onClick:e[7]||(e[7]=a=>T(f.value))},{default:r(()=>[...e[11]||(e[11]=[c("取消",-1)])]),_:1}),l(C,{type:"primary",onClick:e[8]||(e[8]=a=>S(f.value))},{default:r(()=>[...e[12]||(e[12]=[c(" 确定 ",-1)])]),_:1})])],64)}}}),ue=O(ee,[["__scopeId","data-v-acdfafcd"]]);export{ue as default};
