import{t as m,d as x,m as A,i as C,r as F,k as g,a as n,c as M,b as N,e as l,w as s,g as U,f as V,h as c}from"./index-D6YPj1KB.js";const E=t=>m.get("/patrol/list",t),q=t=>m.post("/patrol/add",t),R=t=>m.delete(`/patrol/delete/${t}`),$=t=>m.post("/patrol/deleteAll",t),B={class:"dialog-footer"},h=x({__name:"NightWatchAdd",props:{modelValue:{},modelModifiers:{}},emits:A(["save-success"],["update:modelValue"]),setup(t,{emit:_}){const u=C(t,"modelValue"),r=F(),o=g({address:"",state:"",comment:""}),v=g({address:[{required:!0,message:"请输入巡检地点",trigger:"blur"}],state:[{required:!0,message:"请输入巡检状态",trigger:"blur"}],comment:[{required:!0,message:"请输入巡检记录",trigger:"blur"}]}),b=_,w=async()=>{if(r.value)try{await r.value.validate()}catch{c.error("表单校验失败，请完善必填项");return}try{const d=await q(o);console.log("夜巡添加",d),c.success("添加成功"),u.value=!1,b("save-success"),r.value&&r.value.resetFields()}catch(d){c.error("添加失败，请重试"),console.error("夜巡添加失败",d)}};return(d,e)=>{const i=n("el-input"),p=n("el-form-item"),y=n("el-form"),f=n("el-button"),k=n("el-dialog");return N(),M("div",null,[l(k,{modelValue:u.value,"onUpdate:modelValue":e[4]||(e[4]=a=>u.value=a),title:"新增夜巡",width:"500"},{footer:s(()=>[U("div",B,[l(f,{onClick:e[3]||(e[3]=a=>u.value=!1)},{default:s(()=>[...e[5]||(e[5]=[V("取消",-1)])]),_:1}),l(f,{type:"primary",onClick:w},{default:s(()=>[...e[6]||(e[6]=[V(" 提交 ",-1)])]),_:1})])]),default:s(()=>[l(y,{ref_key:"ruleFormRef",ref:r,style:{"max-width":"600px"},model:o,rules:v,"label-width":"auto"},{default:s(()=>[l(p,{label:"巡检地点",prop:"address"},{default:s(()=>[l(i,{modelValue:o.address,"onUpdate:modelValue":e[0]||(e[0]=a=>o.address=a),placeholder:"请输入巡检地点"},null,8,["modelValue"])]),_:1}),l(p,{label:"巡检状态",prop:"state"},{default:s(()=>[l(i,{modelValue:o.state,"onUpdate:modelValue":e[1]||(e[1]=a=>o.state=a),placeholder:"请输入巡检状态"},null,8,["modelValue"])]),_:1}),l(p,{label:"巡检记录",prop:"comment"},{default:s(()=>[l(i,{modelValue:o.comment,"onUpdate:modelValue":e[2]||(e[2]=a=>o.comment=a),placeholder:"请输入巡检记录"},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue"])])}}});export{h as _,R as a,$ as b,E as p};
