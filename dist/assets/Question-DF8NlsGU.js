import{T as J}from"./table-BDVlGf5e.js";import{q as O,a as D,b as z}from"./Question-D6H1D7k_.js";import H from"./QuestionAdd-DLtC069y.js";import K from"./QuestionUpd-BsTRJOwW.js";import W from"./QuestionParticulars-N1ESVki0.js";import{d as X,r as i,c as T,e as a,n as _,p as C,w as t,u as Y,F as w,b as c,f as v,g as n,v as Z,t as ee,B as le,E as p,h as ae,a as b,_ as te}from"./index-DSXWNbz6.js";import"./TemperatureSelect-CZ-TYvcv.js";import"./elderly-p1gfo6w8.js";import"./oldManRelation-BmOKY2bv.js";const oe=X({__name:"Question",setup(ne){const s=i(null),x=i(!0),r=i({name:"",customerName:"",state:""}),f=i(!1),d=i(!1),m=i(!1),g=i({}),k=i({}),B=()=>{f.value=!1,s.value?.refresh()},V=()=>{s.value?.refresh()},R=()=>{d.value=!1,s.value?.refresh()},S=()=>{m.value=!1,s.value?.refresh()},q=()=>{s.value?.refresh()},U=()=>{r.value={name:"",customerName:"",state:""},s.value?.refresh()},Q=[{type:"selection",width:"50"},{label:"序号",prop:"id"},{label:"咨询类型",prop:"type"},{label:"老人姓名",prop:"customerName"},{label:"咨询渠道",prop:"source"},{label:"咨询人",prop:"name"},{label:"联系方式",prop:"mobile"},{label:"与老人关系",prop:"relation",width:120},{label:"登记日期",prop:"addTime"},{label:"登记人",prop:"addAccountName"},{label:"计划回访日期",prop:"visitTime",width:120},{label:"回访状态",prop:"stateName"},{label:"操作",slot:"operate",width:350,fixed:"right"}],F=[{value:"1",label:"未签约"},{value:"2",label:"预定中"},{value:"3",label:"已住院"}],A=()=>{f.value=!0},E=o=>{le.push({path:"/payAReturnVisit",query:{id:JSON.stringify(o)}})},$=async o=>{try{d.value=!0;const e=await D(o.id);e&&e.code===1e4&&e.data?(g.value=e.data,console.log("编辑数据回显：",g.value)):(p.error("获取编辑数据失败："+(e?.msg||"服务器异常")),d.value=!1)}catch(e){console.error("获取咨询详情失败：",e),p.error("加载编辑数据失败，请稍后重试"),d.value=!1}},L=o=>{ae.confirm("是否删除该条记录？","删除确认",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(async()=>{const e=await z(o);e.code===1e4?(p.success("删除成功"),s.value?.refresh()):p.error("删除失败："+e.msg)}).catch(()=>{p.info("已取消删除")})},M=async o=>{try{m.value=!0;const e=await D(o.id);e&&e.code===1e4&&e.data?(k.value=e.data,console.log("详情：",k.value)):(p.error("详情："+(e?.msg||"服务器异常")),m.value=!1)}catch(e){console.error("获取详情失败：",e),p.error("加载编辑数据失败，请稍后重试"),m.value=!1}},P=o=>{console.log("选中的数据：",o),x.value=o.length===0};return(o,e)=>{const u=c("el-button"),N=c("el-input"),y=c("el-form-item"),j=c("el-option"),G=c("el-select"),I=c("el-form");return b(),T(w,null,[a(J,{ref_key:"tableRef",ref:s,onSelectionChange:P,"init-params":r.value,columns:Q,"fetch-data":Y(O)},{buttons:t(()=>[a(u,{type:"primary",onClick:A},{default:t(()=>[...e[6]||(e[6]=[n("新增咨询",-1)])]),_:1}),a(u,{type:"danger",disabled:x.value},{default:t(()=>[...e[7]||(e[7]=[v("i",{class:"iconfont icon-shanchu"},null,-1),n("批量删除",-1)])]),_:1},8,["disabled"])]),gender:t(({row:l})=>[n(ee(l.gender===1?"男":"女"),1)]),search:t(()=>[a(I,{inline:!0,class:"demo-form-inline",style:{height:"80px"}},{default:t(()=>[a(y,{label:"咨询人姓名:"},{default:t(()=>[a(N,{placeholder:"请输入咨询人姓名",modelValue:r.value.name,"onUpdate:modelValue":e[0]||(e[0]=l=>r.value.name=l),clearable:""},null,8,["modelValue"])]),_:1}),a(y,{label:"老人姓名:"},{default:t(()=>[a(N,{placeholder:"请输入老人姓名",modelValue:r.value.customerName,"onUpdate:modelValue":e[1]||(e[1]=l=>r.value.customerName=l),clearable:""},null,8,["modelValue"])]),_:1}),a(y,{label:"回访状态:"},{default:t(()=>[a(G,{placeholder:"请选择",modelValue:r.value.state,"onUpdate:modelValue":e[2]||(e[2]=l=>r.value.state=l),style:{width:"200px"}},{default:t(()=>[(b(),T(w,null,Z(F,l=>a(j,{key:l.value,label:l.label,value:l.value},null,8,["label","value"])),64))]),_:1},8,["modelValue"])]),_:1}),a(y,null,{default:t(()=>[a(u,{type:"primary",onClick:q},{default:t(()=>[...e[8]||(e[8]=[n("查询",-1)])]),_:1}),a(u,{onClick:U},{default:t(()=>[...e[9]||(e[9]=[n("重置",-1)])]),_:1})]),_:1})]),_:1})]),operate:t(({row:l})=>[a(u,{link:"",type:"primary",onClick:h=>M(l)},{default:t(()=>[...e[10]||(e[10]=[v("i",{class:"iconfont icon-file"},null,-1),n("详情",-1)])]),_:1},8,["onClick"]),a(u,{link:"",type:"primary",onClick:h=>$(l)},{default:t(()=>[...e[11]||(e[11]=[v("i",{class:"iconfont icon-bianji"},null,-1),n("编辑",-1)])]),_:1},8,["onClick"]),a(u,{link:"",type:"primary",onClick:h=>E(l)},{default:t(()=>[...e[12]||(e[12]=[v("i",{class:"iconfont icon-xiangqing"},null,-1),n("回访记录",-1)])]),_:1},8,["onClick"]),a(u,{link:"",type:"danger",onClick:h=>L(l.id)},{default:t(()=>[...e[13]||(e[13]=[v("i",{class:"iconfont icon-shanchu"},null,-1),n("删除",-1)])]),_:1},8,["onClick"])]),_:1},8,["init-params","fetch-data"]),f.value?(b(),_(H,{key:0,handleSuccess:B,modelValue:f.value,"onUpdate:modelValue":e[3]||(e[3]=l=>f.value=l),onRefreshTable:V},null,8,["modelValue"])):C("",!0),d.value?(b(),_(K,{key:1,handleSuccess2:R,modelValue:d.value,"onUpdate:modelValue":e[4]||(e[4]=l=>d.value=l),editData:g.value,onRefreshTable:V},null,8,["modelValue","editData"])):C("",!0),m.value?(b(),_(W,{key:2,handleSuccess3:S,modelValue:m.value,"onUpdate:modelValue":e[5]||(e[5]=l=>m.value=l),editData2:k.value,onRefreshTable:V},null,8,["modelValue","editData2"])):C("",!0)],64)}}}),ve=te(oe,[["__scopeId","data-v-6476680f"]]);export{ve as default};
