import{D as m,d as S,m as V,i as j,r as f,k as h,l as U,b as r,c as I,a as b,e as a,w as u,F as z,v as G,n as H,u as N,f as O,g as k,E as c}from"./index-DSXWNbz6.js";import{h as P}from"./house-0UauvkXi.js";import{u as J}from"./Uploads-hqb4toZy.js";import{_ as K}from"./CascaderBeg.vue_vue_type_script_setup_true_lang-_gtH4QnK.js";const oe=s=>m.get("/house/list",s),ae=s=>m.delete(`/house/delete/${s}`),se=s=>m.post("/house/deleteAll",s),Q=s=>m.post("/house/add",s),W=s=>m.put("/house/update",s),X={class:"dialog-footer"},ue=S({__name:"HouseAdd",props:V({editData:{}},{modelValue:{},modelModifiers:{}}),emits:V(["save-success"],["update:modelValue"]),setup(s,{emit:w}){const n=j(s,"modelValue"),C="http://123.57.237.81:8080/caresystem-server/api",B="http://123.57.237.81:8080/caresystem/",E=C+"/upload/add",x=s,p=f(),e=h({name:"",id:0,buildingId:0,type:0,beds:null,picture:"",typeName:""}),d=f(!1);let D=o=>{e.buildingId=o[o.length-1]};const F=h({name:[{required:!0,message:"请输入房间号",trigger:"blur"}],typeName:[{required:!0,message:"请选择房间类型",trigger:"blur"}],buildingId:[{required:!0,message:"请选择所属楼层",trigger:"change"}],beds:[{required:!0,message:"请输入床位数",trigger:"blur"}],picture:[{required:!0,message:"请选择房间图片",trigger:"blur"}]}),L={page:1,pageSize:10},_=f([]);(async()=>{let o=await P(L);console.log("房间类型",o),_.value=o.data.list})();const q=w,g=()=>{e.name="",e.id=0,e.buildingId=0,e.type=0,e.picture="",e.typeName="",p.value?.clearValidate()};U(()=>x.editData,o=>{o?(d.value=!0,Object.assign(e,o),console.log("子组件接收的编辑数据：",o)):(d.value=!1,g())},{immediate:!0}),U(n,o=>{o||g()});const A=async()=>{if(p.value)try{await p.value.validate()}catch{c.error("表单校验失败，请完善必填项");return}try{d.value?(await W(e),c.success("更新成功")):(await Q(e),c.success("添加成功")),n.value=!1,q("save-success"),g()}catch(o){c.error(d.value?"更新失败，请重试":"添加失败，请重试"),console.error(d.value?"服务更新失败":"服务添加失败",o)}};return(o,l)=>{const v=r("el-input"),i=r("el-form-item"),M=r("el-option"),R=r("el-select"),T=r("el-form"),y=r("el-button"),$=r("el-dialog");return b(),I("div",null,[a($,{modelValue:n.value,"onUpdate:modelValue":l[6]||(l[6]=t=>n.value=t),title:d.value?"编辑房间":"新增房间",width:"500"},{footer:u(()=>[O("div",X,[a(y,{onClick:l[5]||(l[5]=t=>n.value=!1)},{default:u(()=>[...l[7]||(l[7]=[k("取消",-1)])]),_:1}),a(y,{type:"primary",onClick:A},{default:u(()=>[...l[8]||(l[8]=[k(" 提交 ",-1)])]),_:1})])]),default:u(()=>[a(T,{ref_key:"ruleFormRef",ref:p,style:{"max-width":"600px"},model:e,rules:F,"label-width":"auto"},{default:u(()=>[a(i,{label:"房间号",prop:"name"},{default:u(()=>[a(v,{modelValue:e.name,"onUpdate:modelValue":l[0]||(l[0]=t=>e.name=t),placeholder:"请输入房间号"},null,8,["modelValue"])]),_:1}),a(i,{label:"房间类型",prop:"typeName"},{default:u(()=>[a(R,{modelValue:e.typeName,"onUpdate:modelValue":l[1]||(l[1]=t=>e.typeName=t),placeholder:"请选择"},{default:u(()=>[(b(!0),I(z,null,G(_.value,t=>(b(),H(M,{key:t.name,label:t.name,value:t.name},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),a(i,{label:"所属楼层",prop:"buildingId"},{default:u(()=>[a(K,{modelValue:e.buildingId,"onUpdate:modelValue":l[2]||(l[2]=t=>e.buildingId=t),onBedChange:N(D),type:"bed"},null,8,["modelValue","onBedChange"])]),_:1}),a(i,{label:"床位数",prop:"beds"},{default:u(()=>[a(v,{modelValue:e.beds,"onUpdate:modelValue":l[3]||(l[3]=t=>e.beds=t),placeholder:"请输入床位数"},null,8,["modelValue"])]),_:1}),a(i,{label:"房间图片",prop:"picture"},{default:u(()=>[a(J,{modelValue:e.picture,"onUpdate:modelValue":l[4]||(l[4]=t=>e.picture=t),baseUrl:N(B),uploadUrl:E},null,8,["modelValue","baseUrl"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"])])}}});export{ue as _,ae as a,se as b,oe as h};
