import{e as V}from"./company-2RAv3DgF.js";import{P as k}from"./Province-DQ3UkAue.js";import{d as q,m as x,i as A,r as E,j as F,k as b,l as M,b as m,c as O,a as c,e as t,w as o,n as v,p as w,f as S,g as N,q as B,s as J,E as f}from"./index-DSXWNbz6.js";const T={class:"dialog-footer"},K=q({__name:"CompanyEdit",props:x({isAdd:{type:Boolean},handleSuccess:{type:Function},editData:{}},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(g){const u=A(g,"modelValue"),i=g,s=E(),p=F(()=>i.isAdd?"新增机构":"编辑机构"),l=b({id:0,name:"",address:"",adminName:"",telephone:"",adminUserName:"",adminPwd:"",cityInfo:void 0,province:"",city:"",startTime:null,legalPerson:null,mobile:null,creditCode:null,license:0,medicalPoint:0,house:null,certificate:"",picture:"",adminMobile:""}),P=b({name:[{required:!0,message:"请输入机构名称",trigger:"blur"}],cityInfo:[{required:!0,message:"请选择省份城市",trigger:"change"}],address:[{required:!0,message:"请输入所属地区",trigger:"blur"}],adminName:[{required:!0,message:"请输入管理员名称",trigger:"blur"}],telephone:[{required:!0,message:"请输入联系电话",trigger:"blur"},{pattern:/^1[3456789]\d{9}$/,message:"请输入正确的手机号",trigger:"blur"}],adminUserName:[{required:!0,message:"请输入管理员账号",trigger:"blur"}],adminPwd:[{required:!0,message:"请输入密码",trigger:"blur"}]});M(()=>i.editData,d=>{if(!i.isAdd&&d){const e=JSON.parse(JSON.stringify(d));e.adminPwd="",e.province&&e.city&&(e.cityInfo={province:e.province,city:e.city}),Object.assign(l,e)}},{immediate:!0,deep:!0});const U=()=>{Object.assign(l,{id:0,name:"",address:"",adminName:"",telephone:"",adminUserName:"",adminPwd:"",cityInfo:void 0,province:"",city:"",startTime:null,legalPerson:null,mobile:null,creditCode:null,license:0,medicalPoint:0,house:null,certificate:"",picture:"",adminMobile:""}),s.value&&s.value.clearValidate()},_=async()=>{if(JSON.parse(JSON.stringify(l.adminPwd)),!!s.value)try{await s.value.validate(),l.cityInfo&&typeof l.cityInfo!="string"&&(l.province=l.cityInfo.province||"",l.city=l.cityInfo.city||"");const d=await B();l.adminPwd=J.sm2.doEncrypt(l.adminPwd,d.data),i.isAdd?(await V(l),f.success("机构新增成功！")):(await V(l),f.success("机构修改成功！")),u.value=!1,i.handleSuccess()}catch(d){console.error("提交失败:",d),f.error(i.isAdd?"机构新增失败！":"机构修改失败！")}};return(d,e)=>{const n=m("el-input"),r=m("el-form-item"),I=m("el-form"),y=m("el-button"),C=m("el-dialog");return c(),O("div",null,[t(C,{modelValue:u.value,"onUpdate:modelValue":e[8]||(e[8]=a=>u.value=a),title:p.value,width:"500",onClose:U},{footer:o(()=>[S("div",T,[t(y,{onClick:e[7]||(e[7]=a=>u.value=!1)},{default:o(()=>[...e[9]||(e[9]=[N("取消",-1)])]),_:1}),t(y,{type:"primary",onClick:_},{default:o(()=>[...e[10]||(e[10]=[N(" 确定 ",-1)])]),_:1})])]),default:o(()=>[t(I,{ref_key:"ruleFormRef",ref:s,style:{"max-width":"600px"},model:l,rules:P,"label-width":"auto"},{default:o(()=>[t(r,{label:"机构名称",prop:"name"},{default:o(()=>[t(n,{modelValue:l.name,"onUpdate:modelValue":e[0]||(e[0]=a=>l.name=a),placeholder:"请输入机构名称"},null,8,["modelValue"])]),_:1}),t(r,{label:"选择省份",prop:"cityInfo"},{default:o(()=>[t(k,{modelValue:l.cityInfo,"onUpdate:modelValue":e[1]||(e[1]=a=>l.cityInfo=a)},null,8,["modelValue"])]),_:1}),t(r,{label:"所属地区",prop:"address"},{default:o(()=>[t(n,{modelValue:l.address,"onUpdate:modelValue":e[2]||(e[2]=a=>l.address=a),placeholder:"请输入所属地区"},null,8,["modelValue"])]),_:1}),t(r,{label:"管理员名称",prop:"adminName"},{default:o(()=>[t(n,{modelValue:l.adminName,"onUpdate:modelValue":e[3]||(e[3]=a=>l.adminName=a),placeholder:"请输入管理员名称"},null,8,["modelValue"])]),_:1}),t(r,{label:"联系电话",prop:"telephone"},{default:o(()=>[t(n,{modelValue:l.telephone,"onUpdate:modelValue":e[4]||(e[4]=a=>l.telephone=a),placeholder:"请输入联系电话"},null,8,["modelValue"])]),_:1}),p.value!=="编辑机构"?(c(),v(r,{key:0,label:"管理员账号",prop:"adminUserName"},{default:o(()=>[t(n,{modelValue:l.adminUserName,"onUpdate:modelValue":e[5]||(e[5]=a=>l.adminUserName=a),placeholder:"请输入账号"},null,8,["modelValue"])]),_:1})):w("",!0),p.value!=="编辑机构"?(c(),v(r,{key:1,label:"密码",prop:"adminPwd"},{default:o(()=>[t(n,{type:"password",modelValue:l.adminPwd,"onUpdate:modelValue":e[6]||(e[6]=a=>l.adminPwd=a),placeholder:"请输入密码"},null,8,["modelValue"])]),_:1})):w("",!0)]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"])])}}});export{K as _};
