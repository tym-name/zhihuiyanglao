import{p as A,_ as F,a as L,b as M}from"./NightWatchAdd.vue_vue_type_script_setup_true_lang-DJnNeYQ7.js";import{T as W}from"./table-B1my3jl3.js";import{d as j,r as d,a as s,c as y,b,e as l,n as I,p as Q,w as n,g as f,f as i,F as q,x as G,u as V,Q as H,E as k,h as v,_ as J}from"./index-D6YPj1KB.js";const K=j({__name:"NightWatch",setup(O){const x=d("default"),c=d(!1),r=d(null),D=()=>{c.value=!0},a=d({name:"",address:"",state:"",beginDate:"",endDate:""}),C=()=>{_(),r.value?.refresh()},B=()=>{_(),r.value?.refresh()},g=d(!0),_=()=>{a.value.dateRange&&a.value.dateRange.length===2?(a.value.beginDate=a.value.dateRange[0],a.value.endDate=a.value.dateRange[1]):(a.value.beginDate="",a.value.endDate="")},w=o=>{k.confirm("是否删除该条记录？",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(async()=>{await L(o),v({type:"success",message:"删除成功"}),r.value?.refresh()}).catch(()=>{v({type:"info",message:"已取消删除"})})},R=o=>{console.log("选中的数据：",o),m.value=o,g.value=o.length===0},m=d([]),T=()=>{m.value.length!==0&&k.confirm(`是否删除选中的 ${m.value.length} 条记录？`,{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(async()=>{const o=m.value.map(e=>e.id);await M(o),v({type:"success",message:"批量删除成功"}),r.value?.getData(),g.value=!0}).catch(()=>{v({type:"info",message:"已取消删除"})})},N=[{type:"selection",width:"50"},{label:"序号",prop:"id",width:"100px"},{label:"巡检地点",prop:"address"},{label:"巡检上报时间",prop:"addTime"},{label:"上报人",prop:"staffName"},{label:"巡检状态",prop:"state"},{label:"巡检记录",prop:"comment"},{label:"操作",slot:"operate",width:120,fixed:"right"}],S=[{value:"正常",label:"正常"},{value:"异常",label:"异常"},{value:"未巡查",label:"未巡查"}];return(o,e)=>{const u=s("el-button"),h=s("el-input"),p=s("el-form-item"),U=s("el-date-picker"),z=s("el-option"),E=s("el-select"),$=s("el-form");return b(),y("div",null,[l(W,{ref_key:"tableRef",ref:r,onSelectionChange:R,columns:N,"init-params":a.value,"fetch-data":V(A)},{buttons:n(()=>[l(u,{type:"success",onClick:D},{default:n(()=>[...e[6]||(e[6]=[f("i",{class:"iconfont icon-jia"},null,-1),i("添加",-1)])]),_:1}),l(u,{onClick:e[0]||(e[0]=t=>V(H).push("address"))},{default:n(()=>[...e[7]||(e[7]=[f("i",{class:"iconfont icon-dizhiguanli"},null,-1),i("地址管理",-1)])]),_:1}),l(u,{type:"danger",onClick:T,disabled:g.value},{default:n(()=>[...e[8]||(e[8]=[f("i",{class:"iconfont icon-shanchu"},null,-1),i("批量删除 ",-1)])]),_:1},8,["disabled"])]),search:n(()=>[l($,{inline:!0,class:"demo-form-inline"},{default:n(()=>[l(p,{label:"上报人:"},{default:n(()=>[l(h,{placeholder:"请输入上报人",modelValue:a.value.name,"onUpdate:modelValue":e[1]||(e[1]=t=>a.value.name=t)},null,8,["modelValue"])]),_:1}),l(p,{label:"巡检地址:"},{default:n(()=>[l(h,{placeholder:"请输入巡检地址",modelValue:a.value.address,"onUpdate:modelValue":e[2]||(e[2]=t=>a.value.address=t)},null,8,["modelValue"])]),_:1}),l(p,{label:"巡检时间:"},{default:n(()=>[l(U,{style:{width:"200px"},modelValue:a.value.dateRange,"onUpdate:modelValue":e[3]||(e[3]=t=>a.value.dateRange=t),type:"daterange","range-separator":"-","start-placeholder":"开始日期","end-placeholder":"结束日期",size:x.value},null,8,["modelValue","size"])]),_:1}),l(p,{label:"巡检状态:"},{default:n(()=>[l(E,{placeholder:"请选择",modelValue:a.value.state,"onUpdate:modelValue":e[4]||(e[4]=t=>a.value.state=t),style:{width:"200px"}},{default:n(()=>[(b(),y(q,null,G(S,t=>l(z,{key:t.value,label:t.label,value:t.value},null,8,["label","value"])),64))]),_:1},8,["modelValue"])]),_:1}),l(p,null,{default:n(()=>[l(u,{type:"primary",onClick:C},{default:n(()=>[...e[9]||(e[9]=[i("查询",-1)])]),_:1}),l(u,null,{default:n(()=>[...e[10]||(e[10]=[i("重置",-1)])]),_:1})]),_:1})]),_:1})]),operate:n(({row:t})=>[l(u,{link:"",type:"danger",onClick:P=>w(t.id)},{default:n(()=>[...e[11]||(e[11]=[f("i",{class:"iconfont icon-shanchu"},null,-1),i("删除 ",-1)])]),_:1},8,["onClick"])]),_:1},8,["init-params","fetch-data"]),c.value?(b(),I(F,{key:0,onSaveSuccess:B,modelValue:c.value,"onUpdate:modelValue":e[5]||(e[5]=t=>c.value=t)},null,8,["modelValue"])):Q("",!0)])}}}),ee=J(K,[["__scopeId","data-v-6c8dabf4"]]);export{ee as default};
