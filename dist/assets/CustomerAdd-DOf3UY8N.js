import{C as g,S as A}from"./Summary-D2-Jib6K.js";import{F as N}from"./Family-DN0_-m15.js";import{d as V,r as c,k,o as x,z as w,E as t,l as B,n as D,w as u,b as f,e as r,f as F,P as E,u as l,g as y,B as p,a as I,T as R,_ as S}from"./index-DSXWNbz6.js";import{b as j,d as q}from"./customer-s1odyxDc.js";import"./Relation.vue_vue_type_script_setup_true_lang-BFgC7YOg.js";const M={class:"round"},O=V({__name:"CustomerAdd",setup(T){const m=w(),d=c(0);function _(e){Object.assign(s,e)}let s=k({name:"",mobile:"",gender:1,birthday:null,status:"",idCard:"",roomRequire:" ",content:" ",state:1,source:"在线咨询",family:[]}),n=c([]);R("familyData",n),x(async()=>{const e=m.query.id||m.params.id;e&&!isNaN(Number(e))?(d.value=Number(e),await b()):(d.value=0,t.success("进入新增潜在客户页面，请填写相关信息"))});const b=async()=>{try{const e=await j(d.value);if(e&&e.code===1e4){const a=e.data;Object.assign(s,a),a.family&&Array.isArray(a.family)&&(n.value=[...a.family]),t.success("数据加载完成，可进行编辑")}else t.error("获取老人详情失败："+(e?.msg||"接口返回异常"))}catch(e){console.error("获取老人详情出错：",e),t.error("获取老人详情失败，请稍后重试")}},C=async()=>{let e=await q(s);console.log("新增潜在客户",e),t.success("保存成功"),p.push("/Customer")};return B(n,e=>{e&&Array.isArray(e)&&(s.family=[...e])},{deep:!0}),(e,a)=>{const i=f("el-button"),v=f("el-card");return I(),D(v,{class:"elderly-edit-card"},{default:u(()=>[r(g,{modelValue:l(s),"onUpdate:modelValue":a[0]||(a[0]=o=>E(s)?s.value=o:s=o),onForm:_},null,8,["modelValue"]),r(N,{modelValue:l(s).family,"onUpdate:modelValue":a[1]||(a[1]=o=>l(s).family=o)},null,8,["modelValue"]),r(A),F("div",M,[r(i,{onClick:a[2]||(a[2]=o=>l(p).push("/elderly"))},{default:u(()=>[...a[3]||(a[3]=[y("取消",-1)])]),_:1}),r(i,{type:"primary",onClick:C},{default:u(()=>[...a[4]||(a[4]=[y("保存",-1)])]),_:1})])]),_:1})}}}),J=S(O,[["__scopeId","data-v-d62aa2e2"]]);export{J as default};
