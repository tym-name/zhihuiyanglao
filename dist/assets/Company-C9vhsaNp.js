import{c as x,d as j,a as z,b as I}from"./company-2RAv3DgF.js";import{T as G}from"./table-BDVlGf5e.js";import{_ as H}from"./CompanyEdit.vue_vue_type_script_setup_true_lang-CGUsQSQP.js";import{R as L}from"./ResetPasswordDialog-7pXUQv3z.js";import{d as q,o as J,r as o,b as v,c as K,a as O,e as l,w as n,f as m,g as i,u as Q,E as u,h as N,_ as W}from"./index-DSXWNbz6.js";import"./Province-DQ3UkAue.js";const X=q({__name:"Company",setup(Y){J(()=>{console.log("机构列表",x)});const y=o(!1),c=o({name:"",adminName:"",page:1,pageSize:15}),s=o(null),b=o(!0),p=o(!1),h=o(0),g=o(""),B=a=>{h.value=a.id,g.value=a.name,p.value=!0,console.log("传递给弹窗的机构名称：",g.value)},R=()=>{p.value=!1,s.value?.refresh()},D=a=>{u.error(`密码重置失败：${a.msg||"未知错误"}`),console.error("重置密码失败:",a)},d=o(!1),C=o(),w=()=>{d.value=!1,C.value={},s.value?.refresh()},S=()=>{c.value={name:"",adminName:"",page:1,pageSize:15},s.value?.refresh()},T=()=>{s.value?.refresh()},A=()=>{y.value=!0,console.log("点击添加了"),d.value=!0},U=a=>{N.confirm("是否删除该条记录？",{confirmButtonText:"确定",cancelButtonText:"取消"}).then(async()=>{try{await j(a),u({type:"success",message:"删除成功"}),s.value?.refresh()}catch{u({type:"error",message:"删除失败"})}}).catch(()=>{u({type:"info",message:"已取消删除"})})},f=o([]),$=a=>{console.log("rows",a),f.value=a,b.value=a.length===0},E=()=>{f.value.length!==0&&N.confirm("是否删除选中的记录？",{confirmButtonText:"确定",cancelButtonText:"取消"}).then(async()=>{try{await z(f.value.map(a=>a.id)),u({type:"success",message:"删除成功"}),s.value?.refresh(),f.value=[],b.value=!0}catch{u({type:"error",message:"删除失败"})}})},F=async a=>{try{y.value=!1;const e=await I(a);console.log("获取单条机构信息",e),C.value={...e.data},d.value=!0}catch{u({type:"error",message:"获取机构信息失败"})}},M=[{type:"selection",width:"50"},{label:"序号",prop:"id",width:"100px"},{label:"机构名称",prop:"name"},{label:"区域",prop:"address"},{label:"管理员姓名",prop:"adminName"},{label:"联系电话",prop:"telephone"},{label:"管理员账号",prop:"adminUserName"},{label:"操作",slot:"operate",width:320,fixed:"right"}];return(a,e)=>{const r=v("el-button"),k=v("el-input"),_=v("el-form-item"),P=v("el-form");return O(),K("div",null,[l(G,{ref_key:"tableRef",ref:s,onHandleSelectionChange:$,columns:M,"init-params":c.value,"fetch-data":Q(x)},{buttons:n(()=>[l(r,{type:"success",onClick:A},{default:n(()=>[...e[4]||(e[4]=[m("i",{class:"iconfont icon-jia"},null,-1),i("添加",-1)])]),_:1}),l(r,{type:"danger",onClick:E,disabled:b.value},{default:n(()=>[...e[5]||(e[5]=[m("i",{class:"iconfont icon-shanchu"},null,-1),i("批量删除",-1)])]),_:1},8,["disabled"])]),search:n(()=>[l(P,{inline:!0,class:"demo-form-inline"},{default:n(()=>[l(_,{label:"机构名称:"},{default:n(()=>[l(k,{placeholder:"请输入机构名称",modelValue:c.value.name,"onUpdate:modelValue":e[0]||(e[0]=t=>c.value.name=t),clearable:""},null,8,["modelValue"])]),_:1}),l(_,{label:"管理员姓名:"},{default:n(()=>[l(k,{placeholder:"请输入管理员姓名",modelValue:c.value.adminName,"onUpdate:modelValue":e[1]||(e[1]=t=>c.value.adminName=t),clearable:""},null,8,["modelValue"])]),_:1}),l(_,null,{default:n(()=>[l(r,{type:"primary",onClick:T},{default:n(()=>[...e[6]||(e[6]=[i("查询",-1)])]),_:1}),l(r,{onClick:S},{default:n(()=>[...e[7]||(e[7]=[i("重置",-1)])]),_:1})]),_:1})]),_:1})]),operate:n(({row:t})=>[l(r,{link:"",type:"primary",onClick:V=>B(t)},{default:n(()=>[...e[8]||(e[8]=[m("i",{class:"iconfont icon-shuaxin"},null,-1),i("重置密码",-1)])]),_:1},8,["onClick"]),l(r,{link:"",type:"primary",onClick:V=>F(t.id)},{default:n(()=>[...e[9]||(e[9]=[m("i",{class:"iconfont icon-bianji"},null,-1),i("修改",-1)])]),_:1},8,["onClick"]),l(r,{link:"",type:"danger",onClick:V=>U(t.id)},{default:n(()=>[...e[10]||(e[10]=[m("i",{class:"iconfont icon-shanchu"},null,-1),i("删除",-1)])]),_:1},8,["onClick"])]),_:1},8,["init-params","fetch-data"]),l(H,{"is-add":y.value,editData:C.value,handleSuccess:w,modelValue:d.value,"onUpdate:modelValue":e[2]||(e[2]=t=>d.value=t)},null,8,["is-add","editData","modelValue"]),l(L,{visible:p.value,"onUpdate:visible":e[3]||(e[3]=t=>p.value=t),"account-id":h.value,name:g.value,onResetSuccess:R,onResetFail:D},null,8,["visible","account-id","name"])])}}}),oe=W(X,[["__scopeId","data-v-4b856de7"]]);export{oe as default};
