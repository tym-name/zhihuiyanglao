import{p as F,_ as L,a as M,b as W}from"./NightWatchAdd.vue_vue_type_script_setup_true_lang-BS264xPk.js";import{T as j}from"./table-BDVlGf5e.js";import{d as I,r as d,b as s,c as y,a as b,e as l,n as q,p as G,w as n,f,g as r,F as V,v as H,u as k,B as J,h as x,E as v,_ as K}from"./index-DSXWNbz6.js";const O=I({__name:"NightWatch",setup(P){const D=d("default"),c=d(!1),i=d(null),C=()=>{c.value=!0},a=d({name:"",address:"",state:"",beginDate:"",endDate:""}),B=()=>{_(),i.value?.refresh()},w=()=>{_(),i.value?.refresh()},g=d(!0),_=()=>{a.value.dateRange&&a.value.dateRange.length===2?(a.value.beginDate=a.value.dateRange[0],a.value.endDate=a.value.dateRange[1]):(a.value.beginDate="",a.value.endDate="")},R=o=>{x.confirm("是否删除该条记录？",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(async()=>{await M(o),v({type:"success",message:"删除成功"}),i.value?.refresh()}).catch(()=>{v({type:"info",message:"已取消删除"})})},T=o=>{console.log("选中的数据：",o),m.value=o,g.value=o.length===0},m=d([]),N=()=>{m.value.length!==0&&x.confirm(`是否删除选中的 ${m.value.length} 条记录？`,{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(async()=>{const o=m.value.map(e=>e.id);await W(o),v({type:"success",message:"批量删除成功"}),i.value?.getData(),g.value=!0}).catch(()=>{v({type:"info",message:"已取消删除"})})},S=[{type:"selection",width:"50"},{label:"序号",prop:"id",width:"100px"},{label:"巡检地点",prop:"address"},{label:"巡检上报时间",prop:"addTime"},{label:"上报人",prop:"staffName"},{label:"巡检状态",prop:"state"},{label:"巡检记录",prop:"comment"},{label:"操作",slot:"operate",width:120,fixed:"right"}],U=[{value:"正常",label:"正常"},{value:"异常",label:"异常"},{value:"未巡查",label:"未巡查"}];return(o,e)=>{const u=s("el-button"),h=s("el-input"),p=s("el-form-item"),z=s("el-date-picker"),E=s("el-option"),$=s("el-select"),A=s("el-form");return b(),y(V,null,[l(j,{ref_key:"tableRef",ref:i,onSelectionChange:T,columns:S,"init-params":a.value,"fetch-data":k(F)},{buttons:n(()=>[l(u,{type:"success",onClick:C},{default:n(()=>[...e[6]||(e[6]=[f("i",{class:"iconfont icon-jia"},null,-1),r("添加",-1)])]),_:1}),l(u,{onClick:e[0]||(e[0]=t=>k(J).push("address"))},{default:n(()=>[...e[7]||(e[7]=[f("i",{class:"iconfont icon-dizhiguanli"},null,-1),r("地址管理",-1)])]),_:1}),l(u,{type:"danger",onClick:N,disabled:g.value},{default:n(()=>[...e[8]||(e[8]=[f("i",{class:"iconfont icon-shanchu"},null,-1),r("批量删除 ",-1)])]),_:1},8,["disabled"])]),search:n(()=>[l(A,{inline:!0,class:"demo-form-inline"},{default:n(()=>[l(p,{label:"上报人:"},{default:n(()=>[l(h,{placeholder:"请输入上报人",modelValue:a.value.name,"onUpdate:modelValue":e[1]||(e[1]=t=>a.value.name=t)},null,8,["modelValue"])]),_:1}),l(p,{label:"巡检地址:"},{default:n(()=>[l(h,{placeholder:"请输入巡检地址",modelValue:a.value.address,"onUpdate:modelValue":e[2]||(e[2]=t=>a.value.address=t)},null,8,["modelValue"])]),_:1}),l(p,{label:"巡检时间:"},{default:n(()=>[l(z,{style:{width:"200px"},modelValue:a.value.dateRange,"onUpdate:modelValue":e[3]||(e[3]=t=>a.value.dateRange=t),type:"daterange","range-separator":"-","start-placeholder":"开始日期","end-placeholder":"结束日期",size:D.value},null,8,["modelValue","size"])]),_:1}),l(p,{label:"巡检状态:"},{default:n(()=>[l($,{placeholder:"请选择",modelValue:a.value.state,"onUpdate:modelValue":e[4]||(e[4]=t=>a.value.state=t),style:{width:"200px"}},{default:n(()=>[(b(),y(V,null,H(U,t=>l(E,{key:t.value,label:t.label,value:t.value},null,8,["label","value"])),64))]),_:1},8,["modelValue"])]),_:1}),l(p,null,{default:n(()=>[l(u,{type:"primary",onClick:B},{default:n(()=>[...e[9]||(e[9]=[r("查询",-1)])]),_:1}),l(u,null,{default:n(()=>[...e[10]||(e[10]=[r("重置",-1)])]),_:1})]),_:1})]),_:1})]),operate:n(({row:t})=>[l(u,{link:"",type:"danger",onClick:Q=>R(t.id)},{default:n(()=>[...e[11]||(e[11]=[f("i",{class:"iconfont icon-shanchu"},null,-1),r("删除 ",-1)])]),_:1},8,["onClick"])]),_:1},8,["init-params","fetch-data"]),c.value?(b(),q(L,{key:0,onSaveSuccess:w,modelValue:c.value,"onUpdate:modelValue":e[5]||(e[5]=t=>c.value=t)},null,8,["modelValue"])):G("",!0)],64)}}}),ee=K(O,[["__scopeId","data-v-e3e4478d"]]);export{ee as default};
