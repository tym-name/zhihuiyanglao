import{T as D}from"./table-BDVlGf5e.js";import{d as Y,e as W,c as X}from"./Outbound-BmmRsxYx.js";import{d as Z,r,k,o as ee,c as te,e as t,w as l,b as d,u as f,g as i,f as v,J as le,K as ae,L as oe,C as T,B as w,E as b,h as M,a as ne,_ as se}from"./index-DSXWNbz6.js";import{g as ie}from"./elderly-p1gfo6w8.js";const de=[{type:"selection",width:"50"},{label:"序号",prop:"id",width:"100px"},{label:"老人姓名",prop:"elderlyName",width:"100px"},{label:"床位号",prop:"begName"},{label:"陪同人姓名",prop:"name"},{label:"陪同人手机号",prop:"mobile"},{label:"外出时间",prop:"startTime"},{label:"上报人",prop:"addAccountName"},{label:"上报时间",prop:"addTime"},{label:"审批状态",prop:"stateName"},{label:"操作",slot:"operate",width:240,fixed:"right"}],re=[{label:"姓名",prop:"name",width:"100px"},{label:"头像",image:"photo",width:"200px"},{label:"性别",prop:"gender",width:"100px"},{label:"身份证号",prop:"idCard",width:"200px"},{label:"操作",slot:"button",fixed:"right"}],ue={class:"dialog-footer"},pe={class:"button"},me=Z({__name:"GoOut",setup(fe){const u=r(!1),B=()=>{u.value=!1},z=r([]),E=r(0),N=r(10),U=r(1),$=k({name:"",idCard:""}),H=async()=>{const a={page:U.value,pageSize:N.value,...$},e=await Y(a);e.code===1e4&&(z.value=e.data.list,E.value=e.data.counts)},P=a=>{a&&a.length>1?(n.beginDate=a[0]?T(a[0]).format("YYYY-MM-DD HH-mm"):"",n.endDate=a[1]?T(a[1]).format("YYYY-MM-DD HH-mm"):""):(n.beginDate="",n.endDate="")};ee(()=>{H()});const c=r(),n=k({name:"",state:void 0,beginDate:"",endDate:"",startTime:"",endTime:""}),y=r([]),A=()=>{c.value?.refresh()},S=()=>{n.name="",n.startTime="",n.endTime="",n.beginDate="",c.value?.refresh()},L=a=>{y.value=a},p=k({name:"",idCard:""}),_=r(),O=()=>{_.value?.refresh()},R=()=>{p.name="",p.idCard="",_.value?.refresh()},q=a=>{let e=a.id;u.value=!1,w.push("/AddOutings?id="+e)},j=a=>{w.push({path:"/details",query:{id:a.id}})},G=a=>{w.push({path:"/AddOutings",query:{id:a.id,isEdit:"true"}})},I=async()=>{if(!y.value.length)return b.error("请选择要删除的数据");if(!await M.confirm("确定要删除选中的数据吗？","提示",{confirmButtonText:"确定删除",cancelButtonText:"取消",type:"warning"}).catch(()=>{}))return b.info("已取消删除");const e=y.value.map(g=>g.id);await W(e).catch(()=>{}),b.success("删除成功"),c.value?.refresh()},J=async a=>{console.log(a),M.confirm("此删除操作将无法恢复，请确认是否删除?","删除",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(async()=>{await X(a),b({type:"success",message:"删除成功"}),c.value?.refresh()}).catch(()=>{b({type:"info",message:"取消删除"})})};return(a,e)=>{const g=d("el-input"),m=d("el-form-item"),s=d("el-button"),V=d("el-form"),K=d("el-dialog"),h=d("el-option"),F=d("el-select"),Q=d("el-date-picker"),x=d("el-icon");return ne(),te("div",null,[t(K,{modelValue:u.value,"onUpdate:modelValue":e[4]||(e[4]=o=>u.value=o),title:"选择老人",width:"50%","before-close":B},{footer:l(()=>[v("div",ue,[t(s,{onClick:e[2]||(e[2]=o=>u.value=!1)},{default:l(()=>[...e[12]||(e[12]=[i("关闭",-1)])]),_:1}),t(s,{type:"primary",onClick:e[3]||(e[3]=o=>u.value=!1)},{default:l(()=>[...e[13]||(e[13]=[i(" 确定 ",-1)])]),_:1})])]),default:l(()=>[t(D,{columns:f(re),"fetch-data":f(ie),ref_key:"checkRef",ref:_,initParams:p},{search:l(()=>[t(V,{inline:!0},{default:l(()=>[t(m,{label:"姓名:"},{default:l(()=>[t(g,{placeholder:"请输入姓名",clearable:"",style:{width:"200px"},modelValue:p.name,"onUpdate:modelValue":e[0]||(e[0]=o=>p.name=o)},null,8,["modelValue"])]),_:1}),t(m,{label:"身份证号:"},{default:l(()=>[t(g,{placeholder:"请输入身份证号",clearable:"",style:{width:"200px"},modelValue:p.idCard,"onUpdate:modelValue":e[1]||(e[1]=o=>p.idCard=o)},null,8,["modelValue"])]),_:1}),t(m,null,{default:l(()=>[t(s,{onClick:O,type:"primary"},{default:l(()=>[...e[9]||(e[9]=[i("查询",-1)])]),_:1}),t(s,{onClick:R},{default:l(()=>[...e[10]||(e[10]=[i("重置",-1)])]),_:1})]),_:1})]),_:1})]),button:l(o=>[t(s,{type:"primary",onClick:C=>q(o.row)},{default:l(()=>[...e[11]||(e[11]=[i("选择",-1)])]),_:1},8,["onClick"])]),_:1},8,["columns","fetch-data","initParams"])]),_:1},8,["modelValue"]),t(D,{ref_key:"tableRef",ref:c,columns:f(de),"fetch-data":f(Y),initParams:n,onSelectionChange:L},{search:l(()=>[t(V,{inline:!0,class:"demo-form-inline"},{default:l(()=>[t(m,{label:"老人姓名:"},{default:l(()=>[t(g,{placeholder:"请输入老人姓名",clearable:"",style:{width:"200px"},modelValue:n.name,"onUpdate:modelValue":e[5]||(e[5]=o=>n.name=o)},null,8,["modelValue"])]),_:1}),t(m,{label:"审批状态"},{default:l(()=>[t(F,{placeholder:"请选择状态",modelValue:n.state,"onUpdate:modelValue":e[6]||(e[6]=o=>n.state=o),clearable:"",style:{width:"220px"}},{default:l(()=>[t(h,{label:"已返回",value:"0"}),t(h,{label:"未返回",value:"1"}),t(h,{label:"逾期未返回",value:"2"})]),_:1},8,["modelValue"])]),_:1}),t(m,{label:"上报时间:"},{default:l(()=>[t(Q,{type:"datetimerange","start-placeholder":"开始日期","end-placeholder":"结束日期",format:"YYYY-MM-DD HH:mm:ss","date-format":"YYYY/MM/DD ddd",style:{width:"250px"},modelValue:n.beginDate,"onUpdate:modelValue":e[7]||(e[7]=o=>n.beginDate=o),onChange:P},null,8,["modelValue"])]),_:1}),t(m,null,{default:l(()=>[t(s,{onClick:A,type:"primary"},{default:l(()=>[...e[14]||(e[14]=[i("查询",-1)])]),_:1}),t(s,{onClick:S},{default:l(()=>[...e[15]||(e[15]=[i("重置",-1)])]),_:1})]),_:1})]),_:1})]),buttons:l(()=>[v("div",pe,[t(s,{type:"success",onClick:e[8]||(e[8]=o=>u.value=!0)},{default:l(()=>[...e[16]||(e[16]=[v("i",{class:"iconfont icon-jia"},null,-1),i("新增外出",-1)])]),_:1}),t(s,{type:"danger",disabled:y.value.length===0,onClick:I},{default:l(()=>[...e[17]||(e[17]=[v("i",{class:"iconfont icon-shanchu"},null,-1),i("批量删除",-1)])]),_:1},8,["disabled"])])]),operate:l(({row:o})=>[t(s,{onClick:C=>j(o),type:"primary",link:"",size:"small",style:{width:"20px","font-size":"13px !important","margin-right":"8px"}},{default:l(()=>[t(x,null,{default:l(()=>[t(f(le))]),_:1}),e[18]||(e[18]=i("查看详情 ",-1))]),_:1},8,["onClick"]),t(s,{onClick:C=>G(o),type:"primary",link:"",size:"small",style:{width:"60px","font-size":"13px !important","margin-right":"8px"}},{default:l(()=>[t(x,null,{default:l(()=>[t(f(ae))]),_:1}),e[19]||(e[19]=i("编辑 ",-1))]),_:1},8,["onClick"]),t(s,{type:"danger",link:"",size:"small",style:{width:"10px","font-size":"13px !important"},onClick:C=>J(o.id)},{default:l(()=>[t(x,null,{default:l(()=>[t(f(oe))]),_:1}),e[20]||(e[20]=i("删除 ",-1))]),_:1},8,["onClick"])]),_:1},8,["columns","fetch-data","initParams"])])}}}),ve=se(me,[["__scopeId","data-v-d5ff16e0"]]);export{ve as default};
