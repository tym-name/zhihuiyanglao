import{d as C,r as m,o as E,R as U,c as g,e as l,g as t,w as o,a as c,u as w,v as f,f as I,b as x,_ as R}from"./index-D6YPj1KB.js";import{c as B,f as F,h as L}from"./elderly-D3Co0WB3.js";import{u as T}from"./Uploads-CivtU_D6.js";const A=["src"],$={style:{flex:"1",display:"flex","flex-direction":"column",gap:"8px"}},G={style:{display:"flex","align-items":"center","margin-bottom":"10px"}},M={style:{display:"flex","align-items":"center","margin-bottom":"10px"}},S={style:{display:"flex","align-items":"center"}},j={style:{"background-color":"#fff"}},q={key:0,style:{color:"#409EFF",cursor:"pointer"}},z={key:1},D={style:{"text-align":"center",padding:"20px"}},O=C({__name:"ElderlyRecords",setup(P){const i=m({}),N="http://123.57.237.81:8080/caresystem-server/api",v="http://123.57.237.81:8080/caresystem/",k=N+"/upload/add",b=U(),y=m(0),u=m([]),r=m("");E(async()=>{const s=b.query.id||b.params.id;y.value=Number(s);const e=await B(y.value);console.log("老人详情",e),i.value=e.data;const n=await F();console.log("申请表",n),u.value=n.data.list});const V=async s=>{const e=r.value.substring(r.value.lastIndexOf("/")+1),n={elderlyId:y.value,name:s.name,fileName:e,id:0};try{const a=await L(n);console.log("文件上传关联成功",a);const d=u.value.findIndex(_=>_.id===s.id);d!==-1&&(u.value[d].fileName=e),r.value=""}catch(a){console.error("文件上传关联失败",a)}};return(s,e)=>{const n=c("el-card"),a=c("el-table-column"),d=c("el-button"),_=c("el-table");return x(),g("div",null,[l(n,{style:{"margin-bottom":"10px"}},{default:o(()=>[t("img",{src:w(v)+i.value.photo,style:{width:"60px",height:"60px","border-radius":"4px","object-fit":"cover","margin-right":"30px"}},null,8,A),t("div",$,[t("div",G,[e[2]||(e[2]=t("span",{style:{width:"120px","text-align":"left","margin-right":"80px"}},"老人姓名:",-1)),t("span",null,f(i.value.name),1)]),t("div",M,[e[3]||(e[3]=t("span",{style:{width:"120px","text-align":"left","margin-right":"80px"}},"身份证/护照号:",-1)),t("span",null,f(i.value.idCard),1)]),t("div",S,[e[4]||(e[4]=t("span",{style:{width:"120px","text-align":"left","margin-right":"80px"}},"床位号:",-1)),t("span",null,f(i.value.bedNo||"无"),1)])])]),_:1}),t("div",j,[l(_,{data:u.value,border:"",style:{width:"100%"}},{default:o(()=>[l(a,{label:"序号",type:"index",width:"80",align:"center"}),l(a,{label:"项目",prop:"name",align:"center"}),l(a,{label:"文件",prop:"fileName",align:"center"},{default:o(p=>[p.row.fileName?(x(),g("span",q,f(p.row.fileName),1)):(x(),g("span",z,"暂无文件"))]),_:1}),l(a,{label:"操作",align:"center",width:"120"},{default:o(p=>[l(T,{modelValue:r.value,"onUpdate:modelValue":e[0]||(e[0]=h=>r.value=h),baseUrl:w(v),uploadUrl:k,isText:!0},{"upload-text":o(()=>[l(d,{type:"primary",size:"small",onClick:h=>V(p.row)},{default:o(()=>[...e[5]||(e[5]=[I("上传图片",-1)])]),_:1},8,["onClick"])]),_:2},1032,["modelValue","baseUrl"])]),_:1})]),_:1},8,["data"]),t("div",D,[l(d,{type:"primary",onClick:e[1]||(e[1]=p=>s.$router.push("/elderly"))},{default:o(()=>[...e[6]||(e[6]=[I("返回",-1)])]),_:1})])])])}}}),Q=R(O,[["__scopeId","data-v-81daaf8f"]]);export{Q as default};
